<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2021-09-16" />

<title>Day 2 - Module 10: DE Comparisons Results</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02_QC.html">Quality Control</a>
    </li>
    <li>
      <a href="Module02optional_Cutadapt_MultiQC.html">Optional: Cutadapt/MultiQC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module04_Alignment.html">Alignment/Quantification (STAR/RSEM)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module05_MultiQC_and_Count_Matrix.html">Count matrix / Alignment QC</a>
    </li>
    <li>
      <a href="Module05optional_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">Introduction to DESeq2</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DESeq2 Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">Count Normalizations and DESeq2 model fitting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample Visualizations for QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Comparisons and Gene Annotations</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Day 2 - Module 10: DE Comparisons Results</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2021-09-16</h4>

</div>


<!--- Allow the page to be wider --->
<style>
    body .main-container {
        max-width: 1200px;
    }
</style>
<blockquote>
<h1 id="objectives">Objectives</h1>
<ul>
<li>Generate tables of DE results</li>
<li>Understand what a p-value represents.<br />
</li>
<li>Understand multiple hypothesis correction application and importance</li>
</ul>
</blockquote>
<div id="differential-expression-workflow" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Differential Expression Workflow</h1>
<p>Here we will finally test for differential expression between our comparisons of interest.</p>
<p><img src="images/wayfinder_09.png" style="width:75.0%" /></p>
<hr />
</div>
<div id="generating-de-results" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Generating DE results</h1>
<p><em>[Question]: Before we start, what assumptions do you have/have you heard about differential expression comparisons? (Post below or raise zoom ‘hand’ to speak)</em></p>
<p>Now that we have reviewed the plots by sample and determined that our data passed our quality control checks, specifically that the patterns we observe are likely due to our experimental treatments over technical or other confounding factors, we can focus on differential expression testing.</p>
<p>This illustration from the HCB training materials illustrates the basis of the differential expression procedure, where our goal is to compare the distribution of an expressed gene across samples in each treatment groups. <img src="images/de_theory.png" /> <em>Image credit: Paul Pavlidis, UBC</em></p>
<p>Only where the distributions of each group are sufficiently separated will a gene be considered differentially expressed.</p>
<p>This is where having sufficient replicates to overcome within group variance is important, as the more replicates we have in each group the better we can determine the distributions of expression for each group.</p>
<div id="deseq2-statistical-testing" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> DESeq2 statistical testing</h2>
<p>We have already fit our DESeq2 model, specifing our model as <code>~ Gtype.Tx</code> and our next step is to identify genes with significantly different expression between our contrasts of interest. To determine significance, a statistical test is required.</p>
<p>The first step for any statistical test is to define the <em>null hypothesis</em>. In this case, the null hypothesis would be that there is no difference in the expression of a gene between two groups of samples, such as illustrated at the bottom of the first figure in this module. The next step is to use a statistical test to determine if, based on the observed data, the null hypothesis can be rejected.</p>
<p>To do this, <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#theory-behind-deseq2">DESeq2 applies the Wald test</a> to compare two groups. A Wald test statistic is computed as well as the probability that the observed value or more extreme test statistic would be observed. This probability is called the p-value of the test.</p>
<p>If the p-value is smaller than a pre-defined threshold, we would reject the null hypothesis and state that there is evidence against the null, i.e. the gene is differentially expressed. However, if the p-value is larger than our threshold, we would <em>fail to reject</em> the null hypothesis, meaning that we lack evidence that the expression of this gene is different <em>NOT</em> that we have evidence that the expression is indeed the same in both groups.</p>
<p>For a more detailed overview of the statistical comparisons , please refer to <a href="https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html">this HBC tutorial</a> or the <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#theory-behind-deseq2">DESeq2 vignette</a>.</p>
</div>
<div id="optional---dispersion-estimates" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Optional - Dispersion estimates</h2>
<p>As mentioned in the last module, we can visualize the <strong>dispersion estimates</strong> with the <code>plotDispEsts</code> function. This plot shows the the DESeq2 normalization results for our data, which centers on shrinking the variance across all genes to better fit the expected spread at a given expression level.</p>
<pre class="r"><code>plotDispEsts(dds)</code></pre>
<p>If we ran the command above, we would see the raw data plotted in black, the fitted (or expected) dispersion in red, and the normalized data with scaled variance in blue. Since we have fairly small sample sizes for each condition, we see shrinkage for many genes but a reasonable correlation between the expression level and dispersions.</p>
<p>This <a href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html">HBC tutorial</a> has a more detailed overview of estimating size factors, estimating gene dispersion, and the shrinkage procedure, as well as examples of concerning dispersion plots that may suggest reassessing quality of the experimental data.</p>
</div>
<div id="results-table-output" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Results table output</h2>
<p>In the results table that we’ll generate (similar to example shown below), the row name are gene symbols and there are six columns of values that are <a href="https://support.illumina.com/help/BS_App_RNASeq_DE_OLH_1000000071939/Content/Source/Informatics/Apps/DESeq2ResultFile_swBS.htm#:~:text=baseMean%E2%80%94The%20average%20of%20the,factors%2C%20taken%20over%20all%20samples.&amp;text=log2FoldChange%E2%80%93The%20effect%20size%20estimate,the%20comparison%20and%20control%20groups">described in more detail in an Illumina post</a>.</p>
<p><img src="images/DEResultsExample.png" /></p>
<p>The first column, <strong>‘baseMean’</strong> is the average of the normalized count values, divided by size factors and taken over all samples, and can be interpreted as the relative expression level of that gene across all samples.</p>
<p>The second column, <strong>‘log2FoldChange’</strong>, is the log2 transformed ratio of the expression of the numerator group (first group) over the denominator group (second group after “vs”). The third column, <strong>‘lfcSE’</strong> is the standard error for the log2 fold change estimate.</p>
<p>The fourth column, <strong>‘stat’</strong>, is the calculated Wald statistic for that gene, while the fifth column ‘pvalue’ is the <em>nominal</em> significance for that gene.</p>
<div id="multiple-hypothesis-testing-and-fdr-correction" class="section level3" number="2.3.1">
<h3 number="2.3.1"><span class="header-section-number">2.3.1</span> Multiple hypothesis testing and FDR correction</h3>
<p>The sixth column, <strong>‘padj’</strong>, is the <em>adjusted p-value</em> and is what we use for determining significantly differently expressed genes.</p>
<p><em>[Question]: Why do we use values from this column instead of the ‘pvalue’ column?</em></p>
<p>Each p-value is the result of a single test for a single gene. The more genes we test, the greater chance we have of seeing a significant results. This is the multiple testing problem. If we used the p-value directly from the Wald test with a significance cut-off of p &lt; 0.05, that means there is a 5% chance it is a false positives. So if we are testing 20,000 genes for differential expression, we would expect to see ~1,000 significant genes just by chance. This is problematic because we would need to sift through our “significant” genes to identify which ones are true positives.</p>
<p>DESeq2 reduces the number of genes that will be tested by removing genes with low number of counts and outlier samples (gene-level QC, see note below). However, we need to correct for <a href="https://multithreaded.stitchfix.com/blog/2015/10/15/multiple-hypothesis-testing/">multiple hypothesis testing</a> to reduce the number of false positives, and while there are a few common approaches, the default method is False Discovery Rate(FDR)/Benjamini-Hochberg correction which is symbolized as ‘BH’ in DESeq2. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1995.tb02031.x">Benjamini and Hochberg (1995)</a> defined the concept of FDR and created an algorithm to control it below a specified level. An interpretation of the BH method is implemented in DESeq2 in which genes are ranked by p-value, then each ranked p-value is multiplied by the number of total tests divided by rank.</p>
<p><strong>Note</strong>: From the <code>results</code> function help page and <a href="https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html">HBC tutorial that includes overview of multiple hypothesis correction</a>, we can change the multiple hypothesis correction method to an alternative option using the <code>pAdjustMethod =</code> argument.</p>
<p>The default FDR rate cutoff for DESeq2 is <code>alpha = 0.05</code>. By setting the cutoff to &lt; 0.05, we expect that the proportion of false positives amongst our differentially expressed genes is now controlled to 5%. For example, if we call 500 genes as differentially expressed with this FDR cutoff, we expect only 25 of them to be false positives. DESeq2 vignette’s includes a <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#independent-filtering-and-multiple-testing">further discussion of filtering and multiple testing</a></p>
<div id="note-on-padj-values-set-to-na" class="section level4" number="2.3.1.1">
<h4 number="2.3.1.1"><span class="header-section-number">2.3.1.1</span> Note on ‘padj’ values set to NA</h4>
<p>As discussed in the <a href="https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html">HBC tutorial</a> as well as the <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#i-want-to-benchmark-deseq2-comparing-to-other-de-tools.">DESeq2 vignette</a></p>
<ul>
<li>If within a row, all samples have zero counts, the baseMean column will be zero, and the log2 fold change estimates, p-value and adjusted p-value will all be set to NA.<br />
</li>
<li>If a row contains a sample with an extreme count outlier then the p-value and adjusted p-value will be set to NA. These outlier counts are detected by Cook’s distance.<br />
</li>
<li>If a row is filtered by automatic independent filtering, for having a low mean normalized count, then only the adjusted p-value will be set to NA.</li>
</ul>
</div>
</div>
</div>
<div id="generating-results" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Generating results</h2>
<p>We can check what comparisons were automatically generated during fitting using the <code>resultsNames()</code>.</p>
<pre class="r"><code>resultsNames(dds)</code></pre>
<pre><code>## [1] &quot;Intercept&quot;                    &quot;Gtype.Tx_ko.Tx_vs_wt.Tx&quot;     
## [3] &quot;Gtype.Tx_ko.control_vs_wt.Tx&quot; &quot;Gtype.Tx_wt.control_vs_wt.Tx&quot;</code></pre>
<p>Since we are interested in comparing each knockout versus its corresponding wild-type control, only one of the automatically generated comparisons is relevant. We can pull the <code>Tx_ko.Tx_vs_wt.Tx</code> comparison results using the <code>results</code> function and assign those result to a new object.</p>
<pre class="r"><code>Comparison &lt;- &quot;Gtype.Tx_ko.Tx_vs_wt.Tx&quot;
res_Tx &lt;- results(dds, name=Comparison)</code></pre>
<p><em>[Question]: How would we look at our results?</em></p>
<pre class="r"><code>head(res_Tx)</code></pre>
<pre><code>## log2 fold change (MLE): Gtype.Tx ko.Tx vs wt.Tx 
## Wald test p-value: Gtype.Tx ko.Tx vs wt.Tx 
## DataFrame with 6 rows and 6 columns
##                      baseMean log2FoldChange     lfcSE      stat      pvalue        padj
##                     &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;
## ENSMUSG00000000001 6255.78733       0.079621 0.0934295  0.852204 3.94101e-01 6.64152e-01
## ENSMUSG00000000028 1337.98982       0.226230 0.1161800  1.947239 5.15061e-02 2.15863e-01
## ENSMUSG00000000031    3.77363       0.579460 1.1621131  0.498626 6.18043e-01          NA
## ENSMUSG00000000037   27.56347      -0.555188 0.4306035 -1.289324 1.97285e-01 4.66009e-01
## ENSMUSG00000000049    2.25696       0.187564 1.6951093  0.110650 9.11894e-01          NA
## ENSMUSG00000000056 2194.17848      -1.306315 0.1778575 -7.344731 2.06174e-13 3.20181e-11</code></pre>
<p>Note that in our comparison,the log2FoldChange column compares the expression of the numerator group (<code>ko.Tx</code>) over the denominator group (<code>wt.Tx</code>). If the value is positive, that means the expression of that gene is greater across the <code>ko.Tx</code> samples than across the <code>wt.Tx</code> samples. If the value is negative, that means the expression of that gene is greater across the <code>wt.Tx</code> samples.</p>
</div>
<div id="how-to-generate-additional-contrasts" class="section level2" number="2.5">
<h2 number="2.5"><span class="header-section-number">2.5</span> How to generate additional contrasts</h2>
<p>Since our dds object already has the fitted data, if there are comparisons that are not included in the <code>resultsName</code>, we can generate Wald test results by specifying those comparisons as an additional argument to the results function.</p>
<pre class="r"><code>?results</code></pre>
<p>As the function description specifies, we need to provide a list of three elements: the name of the factor in the model design, the name of the numerator for the fold-change, and the name of denominator.</p>
<pre class="r"><code>res_WT &lt;- results(dds, contrast=c(&quot;Gtype.Tx&quot;, &quot;ko.control&quot;, &quot;wt.control&quot;)) 
head(res_WT)</code></pre>
<pre><code>## log2 fold change (MLE): Gtype.Tx ko.control vs wt.control 
## Wald test p-value: Gtype.Tx ko.control vs wt.control 
## DataFrame with 6 rows and 6 columns
##                      baseMean log2FoldChange     lfcSE      stat      pvalue       padj
##                     &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;  &lt;numeric&gt;
## ENSMUSG00000000001 6255.78733    -0.01370173 0.0931866 -0.147035 0.883104082 0.96100310
## ENSMUSG00000000028 1337.98982     0.52267884 0.1359753  3.843924 0.000121082 0.00391537
## ENSMUSG00000000031    3.77363    -1.15621509 1.6006132 -0.722358 0.470074665         NA
## ENSMUSG00000000037   27.56347    -0.27921011 0.4764764 -0.585989 0.557882649 0.80447495
## ENSMUSG00000000049    2.25696     4.01133495 1.8890848  2.123428 0.033718026         NA
## ENSMUSG00000000056 2194.17848    -0.00821319 0.1773220 -0.046318 0.963056826 0.98888983</code></pre>
<p>Now that we’ve generated our differential comparisons and have an understanding of our results, including multiple hypothesis correction, we can proceed with generating summary figures and tables for our differential expression analysis.</p>
<hr />
</div>
</div>
<div id="summary" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Performed statistical tests for comparisons of interest<br />
</li>
<li>Generated tables of differential expression results - i.e. fold changes and adjusted pvalues for each gene in dataset<br />
</li>
<li>Discussed importance and application of multiple hypothesis correction</li>
</ul>
<p>Now that we’ve generated our differential comparisons and have an understanding of our results, including multiple hypothesis correction, we can proceed with generating summary figures and tables for our differential expression analysis.</p>
<hr />
</div>
<div id="sources-used" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Sources Used</h1>
<ul>
<li>HBC DGE training module, part 1: <a href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html" class="uri">https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html</a></li>
<li>HBC DGE training module, part 2: <a href="https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html" class="uri">https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html</a></li>
<li>DESeq2 vignette: <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#differential-expression-analysis" class="uri">http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#differential-expression-analysis</a></li>
</ul>
<hr />
<p><img src="images/significant_xkcd.png" /></p>
<hr />
<p>These materials have been adapted and extended from materials listed above. These are open access materials distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGF5IDIgLSBNb2R1bGUgMTA6IERFIENvbXBhcmlzb25zIFJlc3VsdHMiCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIHRoZW1lOiBwYXBlcgogICAgICAgICAgICB0b2M6IHRydWUKICAgICAgICAgICAgdG9jX2RlcHRoOiA0CiAgICAgICAgICAgIHRvY19mbG9hdDogdHJ1ZQogICAgICAgICAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUKICAgICAgICAgICAgZmlnX2NhcHRpb246IHRydWUKICAgICAgICAgICAgbWFya2Rvd246IEdGTQogICAgICAgICAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCi0tLQoKPCEtLS0gQWxsb3cgdGhlIHBhZ2UgdG8gYmUgd2lkZXIgLS0tPgo8c3R5bGU+CiAgICBib2R5IC5tYWluLWNvbnRhaW5lciB7CiAgICAgICAgbWF4LXdpZHRoOiAxMjAwcHg7CiAgICB9Cjwvc3R5bGU+Cgo+ICMgT2JqZWN0aXZlcyAKPiAqIEdlbmVyYXRlIHRhYmxlcyBvZiBERSByZXN1bHRzCj4gKiBVbmRlcnN0YW5kIHdoYXQgYSBwLXZhbHVlIHJlcHJlc2VudHMuICAgCj4gKiBVbmRlcnN0YW5kIG11bHRpcGxlIGh5cG90aGVzaXMgY29ycmVjdGlvbiBhcHBsaWNhdGlvbiBhbmQgaW1wb3J0YW5jZSAgICAKCgpgYGB7ciBNb2R1bGVzLCBldmFsPVRSVUUsIGVjaG89RkFMU0UsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkoREVTZXEyKQpsaWJyYXJ5KHRpZHlyKQpsaWJyYXJ5KGRwbHlyKQpsb2FkKCJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKIyBEaWZmZXJlbnRpYWwgRXhwcmVzc2lvbiBXb3JrZmxvdwoKSGVyZSB3ZSB3aWxsIGZpbmFsbHkgdGVzdCBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gYmV0d2VlbiBvdXIgY29tcGFyaXNvbnMgb2YgaW50ZXJlc3QuCgohW10oLi9pbWFnZXMvd2F5ZmluZGVyXzA5LnBuZyl7d2lkdGg9NzUlfQoKCi0tLQoKIyBHZW5lcmF0aW5nIERFIHJlc3VsdHMKCipbUXVlc3Rpb25dOiBCZWZvcmUgd2Ugc3RhcnQsIHdoYXQgYXNzdW1wdGlvbnMgZG8geW91IGhhdmUvaGF2ZSB5b3UgaGVhcmQgYWJvdXQgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gY29tcGFyaXNvbnM/IChQb3N0IGJlbG93IG9yIHJhaXNlIHpvb20gJ2hhbmQnIHRvIHNwZWFrKSoKCk5vdyB0aGF0IHdlIGhhdmUgcmV2aWV3ZWQgdGhlIHBsb3RzIGJ5IHNhbXBsZSBhbmQgZGV0ZXJtaW5lZCB0aGF0IG91ciBkYXRhIHBhc3NlZCBvdXIgcXVhbGl0eSBjb250cm9sIGNoZWNrcywgc3BlY2lmaWNhbGx5IHRoYXQgdGhlIHBhdHRlcm5zIHdlIG9ic2VydmUgYXJlIGxpa2VseSBkdWUgdG8gb3VyIGV4cGVyaW1lbnRhbCB0cmVhdG1lbnRzIG92ZXIgdGVjaG5pY2FsIG9yIG90aGVyIGNvbmZvdW5kaW5nIGZhY3RvcnMsIHdlIGNhbiBmb2N1cyBvbiBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiB0ZXN0aW5nLgoKVGhpcyBpbGx1c3RyYXRpb24gZnJvbSB0aGUgSENCIHRyYWluaW5nIG1hdGVyaWFscyBpbGx1c3RyYXRlcyB0aGUgYmFzaXMgb2YgdGhlIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIHByb2NlZHVyZSwgd2hlcmUgb3VyIGdvYWwgaXMgdG8gY29tcGFyZSB0aGUgZGlzdHJpYnV0aW9uIG9mIGFuIGV4cHJlc3NlZCBnZW5lIGFjcm9zcyBzYW1wbGVzIGluIGVhY2ggdHJlYXRtZW50IGdyb3Vwcy4KIVtdKC4vaW1hZ2VzL2RlX3RoZW9yeS5wbmcpCipJbWFnZSBjcmVkaXQ6IFBhdWwgUGF2bGlkaXMsIFVCQyoKCk9ubHkgd2hlcmUgdGhlIGRpc3RyaWJ1dGlvbnMgb2YgZWFjaCBncm91cCBhcmUgc3VmZmljaWVudGx5IHNlcGFyYXRlZCB3aWxsIGEgZ2VuZSBiZSBjb25zaWRlcmVkIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZC4gCgpUaGlzIGlzIHdoZXJlIGhhdmluZyBzdWZmaWNpZW50IHJlcGxpY2F0ZXMgdG8gb3ZlcmNvbWUgd2l0aGluIGdyb3VwIHZhcmlhbmNlIGlzIGltcG9ydGFudCwgYXMgdGhlIG1vcmUgcmVwbGljYXRlcyB3ZSBoYXZlIGluIGVhY2ggZ3JvdXAgdGhlIGJldHRlciB3ZSBjYW4gZGV0ZXJtaW5lIHRoZSBkaXN0cmlidXRpb25zIG9mIGV4cHJlc3Npb24gZm9yIGVhY2ggZ3JvdXAuCgojIyBERVNlcTIgc3RhdGlzdGljYWwgdGVzdGluZwoKV2UgaGF2ZSBhbHJlYWR5IGZpdCBvdXIgREVTZXEyIG1vZGVsLCBzcGVjaWZpbmcgb3VyIG1vZGVsIGFzIGB+IEd0eXBlLlR4YCBhbmQgb3VyIG5leHQgc3RlcCBpcyB0byBpZGVudGlmeSBnZW5lcyB3aXRoIHNpZ25pZmljYW50bHkgZGlmZmVyZW50IGV4cHJlc3Npb24gYmV0d2VlbiBvdXIgY29udHJhc3RzIG9mIGludGVyZXN0LiBUbyBkZXRlcm1pbmUgc2lnbmlmaWNhbmNlLCBhIHN0YXRpc3RpY2FsIHRlc3QgaXMgcmVxdWlyZWQuCgpUaGUgZmlyc3Qgc3RlcCBmb3IgYW55IHN0YXRpc3RpY2FsIHRlc3QgaXMgdG8gZGVmaW5lIHRoZSAqbnVsbCBoeXBvdGhlc2lzKi4gSW4gdGhpcyBjYXNlLCB0aGUgbnVsbCBoeXBvdGhlc2lzIHdvdWxkIGJlIHRoYXQgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBpbiB0aGUgZXhwcmVzc2lvbiBvZiBhIGdlbmUgYmV0d2VlbiB0d28gZ3JvdXBzIG9mIHNhbXBsZXMsIHN1Y2ggYXMgaWxsdXN0cmF0ZWQgYXQgdGhlIGJvdHRvbSBvZiB0aGUgZmlyc3QgZmlndXJlIGluIHRoaXMgbW9kdWxlLiBUaGUgbmV4dCBzdGVwIGlzIHRvIHVzZSBhIHN0YXRpc3RpY2FsIHRlc3QgdG8gZGV0ZXJtaW5lIGlmLCBiYXNlZCBvbiB0aGUgb2JzZXJ2ZWQgZGF0YSwgdGhlIG51bGwgaHlwb3RoZXNpcyBjYW4gYmUgcmVqZWN0ZWQuCgpUbyBkbyB0aGlzLCBbREVTZXEyIGFwcGxpZXMgdGhlIFdhbGQgdGVzdF0oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI3RoZW9yeS1iZWhpbmQtZGVzZXEyKSB0byBjb21wYXJlIHR3byBncm91cHMuIEEgV2FsZCB0ZXN0IHN0YXRpc3RpYyBpcyBjb21wdXRlZCBhcyB3ZWxsIGFzIHRoZSBwcm9iYWJpbGl0eSB0aGF0IHRoZSBvYnNlcnZlZCB2YWx1ZSBvciBtb3JlIGV4dHJlbWUgdGVzdCBzdGF0aXN0aWMgd291bGQgYmUgb2JzZXJ2ZWQuIFRoaXMgcHJvYmFiaWxpdHkgaXMgY2FsbGVkIHRoZSBwLXZhbHVlIG9mIHRoZSB0ZXN0LiAKCklmIHRoZSBwLXZhbHVlIGlzIHNtYWxsZXIgdGhhbiBhIHByZS1kZWZpbmVkIHRocmVzaG9sZCwgd2Ugd291bGQgcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMgYW5kIHN0YXRlIHRoYXQgdGhlcmUgaXMgZXZpZGVuY2UgYWdhaW5zdCB0aGUgbnVsbCwgaS5lLiB0aGUgZ2VuZSBpcyBkaWZmZXJlbnRpYWxseSBleHByZXNzZWQuIEhvd2V2ZXIsIGlmIHRoZSBwLXZhbHVlIGlzIGxhcmdlciB0aGFuIG91ciB0aHJlc2hvbGQsIHdlIHdvdWxkICpmYWlsIHRvIHJlamVjdCogdGhlIG51bGwgaHlwb3RoZXNpcywgbWVhbmluZyB0aGF0IHdlIGxhY2sgZXZpZGVuY2UgdGhhdCB0aGUgZXhwcmVzc2lvbiBvZiB0aGlzIGdlbmUgaXMgZGlmZmVyZW50ICpOT1QqIHRoYXQgd2UgaGF2ZSBldmlkZW5jZSB0aGF0IHRoZSBleHByZXNzaW9uIGlzIGluZGVlZCB0aGUgc2FtZSBpbiBib3RoIGdyb3Vwcy4gCgoKRm9yIGEgbW9yZSBkZXRhaWxlZCBvdmVydmlldyBvZiB0aGUgc3RhdGlzdGljYWwgY29tcGFyaXNvbnMgLCBwbGVhc2UgcmVmZXIgdG8gW3RoaXMgSEJDIHR1dG9yaWFsXShodHRwczovL2hiY3RyYWluaW5nLmdpdGh1Yi5pby9ER0Vfd29ya3Nob3AvbGVzc29ucy8wNV9ER0VfREVTZXEyX2FuYWx5c2lzMi5odG1sKSBvciB0aGUgW0RFU2VxMiB2aWduZXR0ZV0oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI3RoZW9yeS1iZWhpbmQtZGVzZXEyKS4KCgojIyBPcHRpb25hbCAtIERpc3BlcnNpb24gZXN0aW1hdGVzCgpBcyBtZW50aW9uZWQgaW4gdGhlIGxhc3QgbW9kdWxlLCB3ZSBjYW4gdmlzdWFsaXplIHRoZSAqKmRpc3BlcnNpb24gZXN0aW1hdGVzKiogd2l0aCB0aGUgYHBsb3REaXNwRXN0c2AgZnVuY3Rpb24uIFRoaXMgcGxvdCBzaG93cyB0aGUgdGhlIERFU2VxMiBub3JtYWxpemF0aW9uIHJlc3VsdHMgZm9yIG91ciBkYXRhLCB3aGljaCBjZW50ZXJzIG9uIHNocmlua2luZyB0aGUgdmFyaWFuY2UgYWNyb3NzIGFsbCBnZW5lcyB0byBiZXR0ZXIgZml0IHRoZSBleHBlY3RlZCBzcHJlYWQgYXQgYSBnaXZlbiBleHByZXNzaW9uIGxldmVsLiAgCgpgYGB7ciBDaGVja0Rpc3BlcnNpb25zLCBldmFsPUZBTFNFfQpwbG90RGlzcEVzdHMoZGRzKQpgYGAKCklmIHdlIHJhbiB0aGUgY29tbWFuZCBhYm92ZSwgd2Ugd291bGQgc2VlIHRoZSByYXcgZGF0YSBwbG90dGVkIGluIGJsYWNrLCB0aGUgZml0dGVkIChvciBleHBlY3RlZCkgZGlzcGVyc2lvbiBpbiByZWQsIGFuZCB0aGUgbm9ybWFsaXplZCBkYXRhIHdpdGggc2NhbGVkIHZhcmlhbmNlIGluIGJsdWUuIFNpbmNlIHdlIGhhdmUgZmFpcmx5IHNtYWxsIHNhbXBsZSBzaXplcyBmb3IgZWFjaCBjb25kaXRpb24sIHdlIHNlZSBzaHJpbmthZ2UgZm9yIG1hbnkgZ2VuZXMgYnV0IGEgcmVhc29uYWJsZSBjb3JyZWxhdGlvbiBiZXR3ZWVuIHRoZSBleHByZXNzaW9uIGxldmVsIGFuZCBkaXNwZXJzaW9ucy4KClRoaXMgW0hCQyB0dXRvcmlhbF0oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDRfREdFX0RFU2VxMl9hbmFseXNpcy5odG1sKSBoYXMgYSBtb3JlIGRldGFpbGVkIG92ZXJ2aWV3IG9mIGVzdGltYXRpbmcgc2l6ZSBmYWN0b3JzLCBlc3RpbWF0aW5nIGdlbmUgZGlzcGVyc2lvbiwgYW5kIHRoZSBzaHJpbmthZ2UgcHJvY2VkdXJlLCBhcyB3ZWxsIGFzIGV4YW1wbGVzIG9mIGNvbmNlcm5pbmcgZGlzcGVyc2lvbiBwbG90cyB0aGF0IG1heSBzdWdnZXN0IHJlYXNzZXNzaW5nIHF1YWxpdHkgb2YgdGhlIGV4cGVyaW1lbnRhbCBkYXRhLiAKCgojIyBSZXN1bHRzIHRhYmxlIG91dHB1dAoKCkluIHRoZSByZXN1bHRzIHRhYmxlIHRoYXQgd2UnbGwgZ2VuZXJhdGUgKHNpbWlsYXIgdG8gZXhhbXBsZSBzaG93biBiZWxvdyksIHRoZSByb3cgbmFtZSBhcmUgZ2VuZSBzeW1ib2xzIGFuZCB0aGVyZSBhcmUgc2l4IGNvbHVtbnMgb2YgdmFsdWVzIHRoYXQgYXJlIFtkZXNjcmliZWQgaW4gbW9yZSBkZXRhaWwgaW4gYW4gSWxsdW1pbmEgcG9zdF0oaHR0cHM6Ly9zdXBwb3J0LmlsbHVtaW5hLmNvbS9oZWxwL0JTX0FwcF9STkFTZXFfREVfT0xIXzEwMDAwMDAwNzE5MzkvQ29udGVudC9Tb3VyY2UvSW5mb3JtYXRpY3MvQXBwcy9ERVNlcTJSZXN1bHRGaWxlX3N3QlMuaHRtIzp+OnRleHQ9YmFzZU1lYW4lRTIlODAlOTRUaGUlMjBhdmVyYWdlJTIwb2YlMjB0aGUsZmFjdG9ycyUyQyUyMHRha2VuJTIwb3ZlciUyMGFsbCUyMHNhbXBsZXMuJnRleHQ9bG9nMkZvbGRDaGFuZ2UlRTIlODAlOTNUaGUlMjBlZmZlY3QlMjBzaXplJTIwZXN0aW1hdGUsdGhlJTIwY29tcGFyaXNvbiUyMGFuZCUyMGNvbnRyb2wlMjBncm91cHMpLiAKCiFbXShpbWFnZXMvREVSZXN1bHRzRXhhbXBsZS5wbmcpCgpUaGUgZmlyc3QgY29sdW1uLCAqKidiYXNlTWVhbicqKiBpcyB0aGUgYXZlcmFnZSBvZiB0aGUgbm9ybWFsaXplZCBjb3VudCB2YWx1ZXMsIGRpdmlkZWQgYnkgc2l6ZSBmYWN0b3JzIGFuZCB0YWtlbiBvdmVyIGFsbCBzYW1wbGVzLCBhbmQgY2FuIGJlIGludGVycHJldGVkIGFzIHRoZSByZWxhdGl2ZSBleHByZXNzaW9uIGxldmVsIG9mIHRoYXQgZ2VuZSBhY3Jvc3MgYWxsIHNhbXBsZXMuIAoKVGhlIHNlY29uZCBjb2x1bW4sICoqJ2xvZzJGb2xkQ2hhbmdlJyoqLCBpcyB0aGUgbG9nMiB0cmFuc2Zvcm1lZCByYXRpbyBvZiB0aGUgZXhwcmVzc2lvbiBvZiB0aGUgbnVtZXJhdG9yIGdyb3VwIChmaXJzdCBncm91cCkgb3ZlciB0aGUgZGVub21pbmF0b3IgZ3JvdXAgKHNlY29uZCBncm91cCBhZnRlciAidnMiKS4gVGhlIHRoaXJkIGNvbHVtbiwgKionbGZjU0UnKiogaXMgdGhlIHN0YW5kYXJkIGVycm9yIGZvciB0aGUgbG9nMiBmb2xkIGNoYW5nZSBlc3RpbWF0ZS4gCgpUaGUgZm91cnRoIGNvbHVtbiwgKionc3RhdCcqKiwgaXMgdGhlIGNhbGN1bGF0ZWQgV2FsZCBzdGF0aXN0aWMgZm9yIHRoYXQgZ2VuZSwgd2hpbGUgdGhlIGZpZnRoIGNvbHVtbiAncHZhbHVlJyBpcyB0aGUgKm5vbWluYWwqIHNpZ25pZmljYW5jZSBmb3IgdGhhdCBnZW5lLgoKIyMjIE11bHRpcGxlIGh5cG90aGVzaXMgdGVzdGluZyBhbmQgRkRSIGNvcnJlY3Rpb24KClRoZSBzaXh0aCBjb2x1bW4sICoqJ3BhZGonKiosIGlzIHRoZSAqYWRqdXN0ZWQgcC12YWx1ZSogYW5kIGlzIHdoYXQgd2UgdXNlIGZvciBkZXRlcm1pbmluZyBzaWduaWZpY2FudGx5IGRpZmZlcmVudGx5IGV4cHJlc3NlZCBnZW5lcy4gCgoqW1F1ZXN0aW9uXTogV2h5IGRvIHdlIHVzZSB2YWx1ZXMgZnJvbSB0aGlzIGNvbHVtbiBpbnN0ZWFkIG9mIHRoZSAncHZhbHVlJyBjb2x1bW4/KgoKRWFjaCBwLXZhbHVlIGlzIHRoZSByZXN1bHQgb2YgYSBzaW5nbGUgdGVzdCBmb3IgYSBzaW5nbGUgZ2VuZS4gVGhlIG1vcmUgZ2VuZXMgd2UgdGVzdCwgdGhlIGdyZWF0ZXIgY2hhbmNlIHdlIGhhdmUgb2Ygc2VlaW5nIGEgc2lnbmlmaWNhbnQgcmVzdWx0cy4gVGhpcyBpcyB0aGUgbXVsdGlwbGUgdGVzdGluZyBwcm9ibGVtLiBJZiB3ZSB1c2VkIHRoZSBwLXZhbHVlIGRpcmVjdGx5IGZyb20gdGhlIFdhbGQgdGVzdCB3aXRoIGEgc2lnbmlmaWNhbmNlIGN1dC1vZmYgb2YgcCA8IDAuMDUsIHRoYXQgbWVhbnMgdGhlcmUgaXMgYSA1JSBjaGFuY2UgaXQgaXMgYSBmYWxzZSBwb3NpdGl2ZXMuIFNvIGlmIHdlIGFyZSB0ZXN0aW5nIDIwLDAwMCBnZW5lcyBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24sIHdlIHdvdWxkIGV4cGVjdCB0byBzZWUgfjEsMDAwIHNpZ25pZmljYW50IGdlbmVzIGp1c3QgYnkgY2hhbmNlLiBUaGlzIGlzIHByb2JsZW1hdGljIGJlY2F1c2Ugd2Ugd291bGQgbmVlZCB0byBzaWZ0IHRocm91Z2ggb3VyIOKAnHNpZ25pZmljYW504oCdIGdlbmVzIHRvIGlkZW50aWZ5IHdoaWNoIG9uZXMgYXJlIHRydWUgcG9zaXRpdmVzLgoKREVTZXEyIHJlZHVjZXMgdGhlIG51bWJlciBvZiBnZW5lcyB0aGF0IHdpbGwgYmUgdGVzdGVkIGJ5IHJlbW92aW5nIGdlbmVzIHdpdGggbG93IG51bWJlciBvZiBjb3VudHMgYW5kIG91dGxpZXIgc2FtcGxlcyAoZ2VuZS1sZXZlbCBRQywgc2VlIG5vdGUgYmVsb3cpLiBIb3dldmVyLCB3ZSBuZWVkIHRvIGNvcnJlY3QgZm9yIFttdWx0aXBsZSBoeXBvdGhlc2lzIHRlc3RpbmddKGh0dHBzOi8vbXVsdGl0aHJlYWRlZC5zdGl0Y2hmaXguY29tL2Jsb2cvMjAxNS8xMC8xNS9tdWx0aXBsZS1oeXBvdGhlc2lzLXRlc3RpbmcvKSB0byByZWR1Y2UgdGhlIG51bWJlciBvZiBmYWxzZSBwb3NpdGl2ZXMsIGFuZCB3aGlsZSB0aGVyZSBhcmUgYSBmZXcgY29tbW9uIGFwcHJvYWNoZXMsIHRoZSBkZWZhdWx0IG1ldGhvZCBpcyBGYWxzZSBEaXNjb3ZlcnkgUmF0ZShGRFIpL0JlbmphbWluaS1Ib2NoYmVyZyBjb3JyZWN0aW9uIHdoaWNoIGlzIHN5bWJvbGl6ZWQgYXMgJ0JIJyBpbiBERVNlcTIuIFtCZW5qYW1pbmkgYW5kIEhvY2hiZXJnICgxOTk1KV0oaHR0cHM6Ly9yc3Mub25saW5lbGlicmFyeS53aWxleS5jb20vZG9pLzEwLjExMTEvai4yNTE3LTYxNjEuMTk5NS50YjAyMDMxLngpIGRlZmluZWQgdGhlIGNvbmNlcHQgb2YgRkRSIGFuZCBjcmVhdGVkIGFuIGFsZ29yaXRobSB0byBjb250cm9sIGl0IGJlbG93IGEgc3BlY2lmaWVkIGxldmVsLiBBbiBpbnRlcnByZXRhdGlvbiBvZiB0aGUgQkggbWV0aG9kIGlzIGltcGxlbWVudGVkIGluIERFU2VxMiBpbiB3aGljaCBnZW5lcyBhcmUgcmFua2VkIGJ5IHAtdmFsdWUsIHRoZW4gZWFjaCByYW5rZWQgcC12YWx1ZSBpcyBtdWx0aXBsaWVkIGJ5IHRoZSBudW1iZXIgb2YgdG90YWwgdGVzdHMgZGl2aWRlZCBieSByYW5rLgoKKipOb3RlKio6IEZyb20gdGhlIGByZXN1bHRzYCBmdW5jdGlvbiBoZWxwIHBhZ2UgYW5kIFtIQkMgdHV0b3JpYWwgdGhhdCBpbmNsdWRlcyBvdmVydmlldyBvZiBtdWx0aXBsZSBoeXBvdGhlc2lzIGNvcnJlY3Rpb25dKGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzA1X0RHRV9ERVNlcTJfYW5hbHlzaXMyLmh0bWwpLCB3ZSBjYW4gY2hhbmdlIHRoZSBtdWx0aXBsZSBoeXBvdGhlc2lzIGNvcnJlY3Rpb24gbWV0aG9kIHRvIGFuIGFsdGVybmF0aXZlIG9wdGlvbiB1c2luZyB0aGUgYHBBZGp1c3RNZXRob2QgPWAgYXJndW1lbnQuCgpUaGUgZGVmYXVsdCBGRFIgcmF0ZSBjdXRvZmYgZm9yIERFU2VxMiBpcyBgYWxwaGEgPSAwLjA1YC4gQnkgc2V0dGluZyB0aGUgY3V0b2ZmIHRvIDwgMC4wNSwgd2UgZXhwZWN0IHRoYXQgdGhlIHByb3BvcnRpb24gb2YgZmFsc2UgcG9zaXRpdmVzIGFtb25nc3Qgb3VyIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcyBpcyBub3cgY29udHJvbGxlZCB0byA1JS4gRm9yIGV4YW1wbGUsIGlmIHdlIGNhbGwgNTAwIGdlbmVzIGFzIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCB3aXRoIHRoaXMgRkRSIGN1dG9mZiwgd2UgZXhwZWN0IG9ubHkgMjUgb2YgdGhlbSB0byBiZSBmYWxzZSBwb3NpdGl2ZXMuIERFU2VxMiB2aWduZXR0ZSdzIGluY2x1ZGVzIGEgW2Z1cnRoZXIgZGlzY3Vzc2lvbiBvZiBmaWx0ZXJpbmcgYW5kIG11bHRpcGxlIHRlc3RpbmddKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCNpbmRlcGVuZGVudC1maWx0ZXJpbmctYW5kLW11bHRpcGxlLXRlc3RpbmcpCgojIyMjIE5vdGUgb24gJ3BhZGonIHZhbHVlcyBzZXQgdG8gTkEKCkFzIGRpc2N1c3NlZCBpbiB0aGUgW0hCQyB0dXRvcmlhbF0oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDVfREdFX0RFU2VxMl9hbmFseXNpczIuaHRtbCkgYXMgd2VsbCBhcyB0aGUgW0RFU2VxMiB2aWduZXR0ZV0oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI2ktd2FudC10by1iZW5jaG1hcmstZGVzZXEyLWNvbXBhcmluZy10by1vdGhlci1kZS10b29scy4pICAgIAoKKiBJZiB3aXRoaW4gYSByb3csIGFsbCBzYW1wbGVzIGhhdmUgemVybyBjb3VudHMsIHRoZSBiYXNlTWVhbiBjb2x1bW4gd2lsbCBiZSB6ZXJvLCBhbmQgdGhlIGxvZzIgZm9sZCBjaGFuZ2UgZXN0aW1hdGVzLCBwLXZhbHVlIGFuZCBhZGp1c3RlZCBwLXZhbHVlIHdpbGwgYWxsIGJlIHNldCB0byBOQS4gICAgCiogSWYgYSByb3cgY29udGFpbnMgYSBzYW1wbGUgd2l0aCBhbiBleHRyZW1lIGNvdW50IG91dGxpZXIgdGhlbiB0aGUgcC12YWx1ZSBhbmQgYWRqdXN0ZWQgcC12YWx1ZSB3aWxsIGJlIHNldCB0byBOQS4gVGhlc2Ugb3V0bGllciBjb3VudHMgYXJlIGRldGVjdGVkIGJ5IENvb2vigJlzIGRpc3RhbmNlLiAgICAgCiogSWYgYSByb3cgaXMgZmlsdGVyZWQgYnkgYXV0b21hdGljIGluZGVwZW5kZW50IGZpbHRlcmluZywgZm9yIGhhdmluZyBhIGxvdyBtZWFuIG5vcm1hbGl6ZWQgY291bnQsIHRoZW4gb25seSB0aGUgYWRqdXN0ZWQgcC12YWx1ZSB3aWxsIGJlIHNldCB0byBOQS4gICAKCgojIyBHZW5lcmF0aW5nIHJlc3VsdHMKCldlIGNhbiBjaGVjayB3aGF0IGNvbXBhcmlzb25zIHdlcmUgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgZHVyaW5nIGZpdHRpbmcgdXNpbmcgdGhlIGByZXN1bHRzTmFtZXMoKWAuIApgYGB7ciBSZXN1bHRzMX0KcmVzdWx0c05hbWVzKGRkcykKYGBgCgpTaW5jZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBjb21wYXJpbmcgZWFjaCBrbm9ja291dCB2ZXJzdXMgaXRzIGNvcnJlc3BvbmRpbmcgd2lsZC10eXBlIGNvbnRyb2wsIG9ubHkgb25lIG9mIHRoZSBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBjb21wYXJpc29ucyBpcyByZWxldmFudC4gV2UgY2FuIHB1bGwgdGhlIGBUeF9rby5UeF92c193dC5UeGAgY29tcGFyaXNvbiByZXN1bHRzIHVzaW5nIHRoZSBgcmVzdWx0c2AgZnVuY3Rpb24gYW5kIGFzc2lnbiB0aG9zZSByZXN1bHQgdG8gYSBuZXcgb2JqZWN0LgpgYGB7ciBTZXRzUmVzdWx0fQpDb21wYXJpc29uIDwtICJHdHlwZS5UeF9rby5UeF92c193dC5UeCIKcmVzX1R4IDwtIHJlc3VsdHMoZGRzLCBuYW1lPUNvbXBhcmlzb24pCmBgYAoKKltRdWVzdGlvbl06IEhvdyB3b3VsZCB3ZSBsb29rIGF0IG91ciByZXN1bHRzPyoKCmBgYHtyIFJlc3VsdHNLRH0KaGVhZChyZXNfVHgpCmBgYAoKTm90ZSB0aGF0IGluIG91ciBjb21wYXJpc29uLHRoZSBsb2cyRm9sZENoYW5nZSBjb2x1bW4gY29tcGFyZXMgdGhlIGV4cHJlc3Npb24gb2YgdGhlIG51bWVyYXRvciBncm91cCAoYGtvLlR4YCkgb3ZlciB0aGUgZGVub21pbmF0b3IgZ3JvdXAgKGB3dC5UeGApLiBJZiB0aGUgdmFsdWUgaXMgcG9zaXRpdmUsIHRoYXQgbWVhbnMgdGhlIGV4cHJlc3Npb24gb2YgdGhhdCBnZW5lIGlzIGdyZWF0ZXIgYWNyb3NzIHRoZSBga28uVHhgIHNhbXBsZXMgdGhhbiBhY3Jvc3MgdGhlIGB3dC5UeGAgc2FtcGxlcy4gSWYgdGhlIHZhbHVlIGlzIG5lZ2F0aXZlLCB0aGF0IG1lYW5zIHRoZSBleHByZXNzaW9uIG9mIHRoYXQgZ2VuZSBpcyBncmVhdGVyIGFjcm9zcyB0aGUgYHd0LlR4YCBzYW1wbGVzLiAKCiMjIEhvdyB0byBnZW5lcmF0ZSBhZGRpdGlvbmFsIGNvbnRyYXN0cwoKU2luY2Ugb3VyIGRkcyBvYmplY3QgYWxyZWFkeSBoYXMgdGhlIGZpdHRlZCBkYXRhLCBpZiB0aGVyZSBhcmUgY29tcGFyaXNvbnMgdGhhdCBhcmUgbm90IGluY2x1ZGVkIGluIHRoZSBgcmVzdWx0c05hbWVgLCB3ZSBjYW4gZ2VuZXJhdGUgV2FsZCB0ZXN0IHJlc3VsdHMgYnkgc3BlY2lmeWluZyB0aG9zZSBjb21wYXJpc29ucyBhcyBhbiBhZGRpdGlvbmFsIGFyZ3VtZW50IHRvIHRoZSByZXN1bHRzIGZ1bmN0aW9uLiAKYGBge3IgUmVzdWx0c0Z1bmN0aW9ufQo/cmVzdWx0cwpgYGAKCkFzIHRoZSBmdW5jdGlvbiBkZXNjcmlwdGlvbiBzcGVjaWZpZXMsIHdlIG5lZWQgdG8gcHJvdmlkZSBhIGxpc3Qgb2YgdGhyZWUgZWxlbWVudHM6IHRoZSBuYW1lIG9mIHRoZSBmYWN0b3IgaW4gdGhlIG1vZGVsIGRlc2lnbiwgdGhlIG5hbWUgb2YgdGhlIG51bWVyYXRvciBmb3IgdGhlIGZvbGQtY2hhbmdlLCBhbmQgdGhlIG5hbWUgb2YgZGVub21pbmF0b3IuIApgYGB7ciBBZGRpdGlvbmFsQ29tcGFyaXNvbnN9CnJlc19XVCA8LSByZXN1bHRzKGRkcywgY29udHJhc3Q9YygiR3R5cGUuVHgiLCAia28uY29udHJvbCIsICJ3dC5jb250cm9sIikpIApoZWFkKHJlc19XVCkKYGBgCgoKCk5vdyB0aGF0IHdlJ3ZlIGdlbmVyYXRlZCBvdXIgZGlmZmVyZW50aWFsIGNvbXBhcmlzb25zIGFuZCBoYXZlIGFuIHVuZGVyc3RhbmRpbmcgb2Ygb3VyIHJlc3VsdHMsIGluY2x1ZGluZyBtdWx0aXBsZSBoeXBvdGhlc2lzIGNvcnJlY3Rpb24sIHdlIGNhbiBwcm9jZWVkIHdpdGggZ2VuZXJhdGluZyBzdW1tYXJ5IGZpZ3VyZXMgYW5kIHRhYmxlcyBmb3Igb3VyIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGFuYWx5c2lzLgoKLS0tCgojIFN1bW1hcnkgCgpJbiB0aGlzIHNlY3Rpb24sIHdlOiAgICAKCiogUGVyZm9ybWVkIHN0YXRpc3RpY2FsIHRlc3RzIGZvciBjb21wYXJpc29ucyBvZiBpbnRlcmVzdCAgICAgCiogR2VuZXJhdGVkIHRhYmxlcyBvZiBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiByZXN1bHRzIC0gaS5lLiBmb2xkIGNoYW5nZXMgYW5kIGFkanVzdGVkIHB2YWx1ZXMgZm9yIGVhY2ggZ2VuZSBpbiBkYXRhc2V0ICAgICAgCiogRGlzY3Vzc2VkIGltcG9ydGFuY2UgYW5kIGFwcGxpY2F0aW9uIG9mIG11bHRpcGxlIGh5cG90aGVzaXMgY29ycmVjdGlvbiAgICAgIAoKCk5vdyB0aGF0IHdlJ3ZlIGdlbmVyYXRlZCBvdXIgZGlmZmVyZW50aWFsIGNvbXBhcmlzb25zIGFuZCBoYXZlIGFuIHVuZGVyc3RhbmRpbmcgb2Ygb3VyIHJlc3VsdHMsIGluY2x1ZGluZyBtdWx0aXBsZSBoeXBvdGhlc2lzIGNvcnJlY3Rpb24sIHdlIGNhbiBwcm9jZWVkIHdpdGggZ2VuZXJhdGluZyBzdW1tYXJ5IGZpZ3VyZXMgYW5kIHRhYmxlcyBmb3Igb3VyIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGFuYWx5c2lzLgoKCi0tLQoKCiMgU291cmNlcyBVc2VkCiogSEJDIERHRSB0cmFpbmluZyBtb2R1bGUsIHBhcnQgMTogaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDRfREdFX0RFU2VxMl9hbmFseXNpcy5odG1sCiogSEJDIERHRSB0cmFpbmluZyBtb2R1bGUsIHBhcnQgMjogaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDVfREdFX0RFU2VxMl9hbmFseXNpczIuaHRtbAoqIERFU2VxMiB2aWduZXR0ZTogaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI2RpZmZlcmVudGlhbC1leHByZXNzaW9uLWFuYWx5c2lzCgotLS0KCiFbXSguL2ltYWdlcy9zaWduaWZpY2FudF94a2NkLnBuZykKCgpgYGB7ciBXcml0ZU91dC5SRGF0YSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQojSGlkZGVuIGNvZGUgYmxvY2sgdG8gd3JpdGUgb3V0IGRhdGEgZm9yIGtuaXR0aW5nCnNhdmUuaW1hZ2UoZmlsZSA9ICJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKCi0tLQoKClRoZXNlIG1hdGVyaWFscyBoYXZlIGJlZW4gYWRhcHRlZCBhbmQgZXh0ZW5kZWQgZnJvbSBtYXRlcmlhbHMgbGlzdGVkIGFib3ZlLiBUaGVzZSBhcmUgb3BlbiBhY2Nlc3MgbWF0ZXJpYWxzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgW0NyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gbGljZW5zZSAoQ0MgQlkgNC4wKV0oaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wLyksIHdoaWNoIHBlcm1pdHMgdW5yZXN0cmljdGVkIHVzZSwgZGlzdHJpYnV0aW9uLCBhbmQgcmVwcm9kdWN0aW9uIGluIGFueSBtZWRpdW0sIHByb3ZpZGVkIHRoZSBvcmlnaW5hbCBhdXRob3IgYW5kIHNvdXJjZSBhcmUgY3JlZGl0ZWQuCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module10_DEComparisons.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2021-11-13" />

<title>Day 3 - Module 09: Sample Visualizations for Quality Control</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02_QC.html">Quality Control</a>
    </li>
    <li>
      <a href="Module02optional_Cutadapt_MoreQC.html">Optional: Cutadapt/MoreQC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module04_Alignment.html">Alignment/Quantification (STAR/RSEM)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module05_MultiQC_and_Count_Matrix.html">Count matrix / Alignment QC</a>
    </li>
    <li>
      <a href="Module05optional_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">Introduction to DESeq2</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DESeq2 Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">Count Normalizations and DESeq2 model fitting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample Visualizations for QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">Comparisons</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visiualization and Annotation</a>
    </li>
    <li>
      <a href="Module11X_BonusContent.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Day 3 - Module 09: Sample Visualizations for Quality Control</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2021-11-13</h4>

</div>


<style type="text/css">
body{ /* Normal  */
      font-size: 14pt;
  }
pre {
  font-size: 12pt
}
code.r{
  font-size: 12pt;
}
</style>
<!--- Allow the page to be wider --->
<style>
    body .main-container {
        max-width: 1200px;
    }
</style>
<blockquote>
<h1 id="objectives">Objectives:</h1>
<ul>
<li>Generate common QC visualizations<br />
</li>
<li>Understand how to interpret QC visualizations<br />
</li>
<li>Understand when to revise the model used in the DESeq2 initialization<br />
</li>
<li>Understand the pitfalls of post-hoc analysis<br />
</li>
<li>Describe the causes and implications of batch effect or other QC issues in an RNA-Seq experiment</li>
</ul>
</blockquote>
<div id="differential-expression-workflow" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Differential Expression Workflow</h1>
<p>Prior to testing for differential expression between our comparisons of interest, we’ll first generate plots that will assess how well our samples match up with our expectations (based on their treatment groups) and what we might expect to see from our differential expression comparisons.</p>
<p><img src="images/wayfinder/wayfinder-05.png" style="width:75.0%" /></p>
<hr />
</div>
<div id="sample-visualizatons-for-quality-control" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Sample Visualizatons for Quality Control</h1>
<p>Yesterday we discussed aspects of quality control assessment at the sequencing data level. Today we will outline sample-level and gene-level quality control assessments to determine what we should expect from our downstream differential expression comparisons.</p>
<p>To do this, we will first assess the similarity of our samples by using principal component analysis (PCA). This will allow us to determine how well patterns in the data fits our expectations from the experiments design and possible sources of variation in the dataset.</p>
<p>Other common visualizations that we generate for our analyses include expression heatmaps, sample correlation heatmaps, and boxplots of raw and/or normalized counts, the code for which can be found in the bonus content module.</p>
<p><strong>TODO: DOUBLE CHHECK INTRO AFTER CHANGING VISUALIZATION</strong></p>
<div id="principle-component-analysis-pca-plots" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Principle Component Analysis (PCA) Plots</h2>
<p>A common and very useful plot for evaluating how well our samples cluster by treatment groups are Principle Component Analysis (PCA) plots. PCA is used to emphasize variation and bring out patterns in large datasets by using dimensionality redution.</p>
<p>This image from <a href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/">a helpful step by step explaination of PCA</a> helps to illustrate the principle component projections for two genes measured in approximately 60 mouse samples. Generally, this process is repeated and after each gene’s contribution to a principle component or weight is determined, the expression and weight are summed across genes for each sample to calculate a value for each principle component.</p>
<p><img src="images/Blog_pca_6b.png" /></p>
<blockquote>
<p><strong>Note</strong>: A more detailed overview of the PCA procedure is outlined in <a href="https://hbctraining.github.io/DGE_workshop/lessons/principal_component_analysis.html">a Harvard Chan Bioinformatic Core training module</a> and is based on a more thorough description presented in a <a href="https://www.youtube.com/watch?v=_UVHneBUBW0">StatQuest’s video</a>. Additionally, <a href="https://towardsdatascience.com/principal-component-analysis-3c39fbf5cb9d">this TowardsDataScience blog post</a> goes through the math behind PCAs.</p>
</blockquote>
<div id="interpreting-pca-plots" class="section level3" number="2.1.1">
<h3 number="2.1.1"><span class="header-section-number">2.1.1</span> Interpreting PCA plots</h3>
<p><img src="images/PCAplot_Fancy_rlog_ko.Tx.png" style="width:75.0%" /></p>
<p>In this plot, which is similar to what we’ll generate below for our data, principle component 1 (PC1) explains ~80% of the variance in our data while principle component 2 (PC2) explains ~12% of the variance.</p>
<p>For most experiments, we expect the majority of the total variance to be explained by the first two or three principle components so this plot.</p>
<p><em>[Question]: How might we interpret the variance explained by each principle component in the context of the labeled sample points?</em></p>
<p>For more information, this <a href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/">helpful overview of PCA basics</a> walks through both the generation and interpretation of similar plots.</p>
</div>
<div id="evaluating-batch-effects-or-confounders" class="section level3" number="2.1.2">
<h3 number="2.1.2"><span class="header-section-number">2.1.2</span> Evaluating batch effects or confounders</h3>
<p>PCA plots are useful for evaluating the impact of factors other than the experimental treatment or group.</p>
<p>At times, batch effects can be quite obvious, such as this example from the <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2 vignette</a>, where there is clear separation within the treatment groups.</p>
<p><img src="images/PCA1_DESeq2Vignette.png" /></p>
<p>If we color only by sequencing run type (paired-end vs. single-end), we see that PC2 (29% of variance) is primarily explained by this technical covariate.</p>
<p><img src="images/PCA2_DESeq2Vignette.png" /></p>
<p>However, the samples are clearly seperated by experimental condition on PC1, and since PC1 explains more variance than PC2 <strong>and</strong> since we have non-confounded batches, we could incorporate the technical covariate into our model design, such as outlined in the <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#multi-factor-designs">DESeq2 vignette</a>.</p>
<details>
<summary>
<em>Click for complex design discussion</em>
</summary>
In experiments with more complex designs, such as when there are interesecting/multiple treatment conditions, it can be less clear what covariants are influencing expression, such as illustrated from <a href="http://www.molmine.com/magma/global_analysis/batch_effect.html">this documenation for a microarray analysis tool</a>. From the PCA labeled by experimental treatment, we see that samples from the treatment group do not cluster together and that there is high variance across all treatment groups. <img src="images/batch_ex1b.jpg" /> However, when the plot is color coded by the technical batches of probe labeling, we see that the patterns in the data are better explained by batch than the experimental conditions. <img src="images/batch_ex1c.jpg" />
</details>
<div id="when-to-remove-samples-or-update-the-design-formula" class="section level4" number="2.1.2.1">
<h4 number="2.1.2.1"><span class="header-section-number">2.1.2.1</span> When to remove samples or update the design formula</h4>
<p>Generally, the decision to remove samples should not be taken lightly, especially if the consideration is based on the expression level patterns we are visualizing in this section, as doing so without sufficient justification could potentially bias your results. Other training materials have a step-by-step example of evaluating <a href="https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html">batch effects</a> using PCAs, that we would recommend reviewing prior to removing any samples from your comparisons.</p>
<p>If your PCA reveals patterns that were not accounted for in the initial model fit, the <a href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#multi-factor-designs">DESeq2 vignette</a> provides an overview of how to add additional covariates to a model design before refitting the DESeq2 model for a dataset.</p>
</div>
</div>
</div>
<div id="plot-setup" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Plot Setup</h2>
<p>We’ve already loaded the libraries we need for this module. We’ll follow best practices and create new directories to organize our output figures, as well as a variable to store a descriptor of the dataset we are looking at so we can more easily recycle our plotting functions.</p>
<pre class="r"><code>plotPath = &#39;figures/&#39;
dir.create(plotPath, showWarnings = FALSE)
Comparison &lt;- &quot;Gtype.Tx&quot; # descriptor for the dataset we are looking at</code></pre>
</div>
<div id="pca-plot-initialization" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> PCA Plot initialization</h2>
<p>Below, we will plot the rlog normalized data for our samples projected onto a 2D plane and spanned by their first two principle components to visualize the overall effect of experimental covariates and determine if there is evidence of batch effects.</p>
<p>We’ll generate the PCA projections for the top 500 using the <code>plotPCA</code> function from DESeq2, specifying <code>Gtype.Tx</code> as the condition of interest, and view the simple plot generated by the function.</p>
<pre class="r"><code>p.all &lt;- plotPCA(rld, intgroup = c(&#39;Gtype.Tx&#39;), ntop = 500)
p.all</code></pre>
<p><img src="Module09_SampleQCViz_files/figure-html/PCArlog3-1.png" width="672" /></p>
<p>We also see that samples in both <code>control</code> groups are fairly tightly grouped, while samples within each <code>Tx</code> group do not cluster as tightly. There does not appear to be any clear evidence of batch effects.</p>
<p>Next, we’ll save this plot to file.</p>
<pre class="r"><code>pdf(file = paste0(plotPath, &#39;PCAplot_rlog_&#39;, Comparison, &#39;.pdf&#39;), onefile = TRUE)
p.all
dev.off()</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p><strong>Checkpoint</strong>: <em>If generated and saved the <code>p.all</code> PCA plot, please indicate with the green ‘check’ button. Otherwise, please use use the red ‘x’ button in your zoom reaction panel to have this step repeated.</em></p>
<div id="exercise-pca-plot-customization-with-ggplot2" class="section level4" number="2.3.0.1">
<h4 number="2.3.0.1"><span class="header-section-number">2.3.0.1</span> [Exercise]: PCA plot customization with ggplot2</h4>
<p>We can generate a customized plot using the <code>ggplot2</code> package, including shape assignments for our treatment groups and color assignments for the individual samples.</p>
<p>**TODO: break into multiple guided stanza’s (with solutions)</p>
<p>First, we need to create some objects to store the sample and group information.</p>
<pre class="r"><code>#PCA plot for Rlog-Normalized counts for all samples
CombinatoricGroup &lt;- factor(MetaInfo$Gtype.Tx)
SampleName &lt;- factor(row.names(MetaInfo))</code></pre>
<p>Take a look at <code>CombinatoricGroup</code> and <code>SampleName</code> - what information is now stored in these objects?</p>
<p>Next, look at the documentation for <code>plotPCA</code> function from DESeq2. Then write a command to store the PCA results for the top 500 genes for <code>intgroup</code> = ‘Gtype.Tx’, using the normalized data, as an object named <code>p.all</code>.</p>
<details>
<summary>
<em>Click for solution</em>
</summary>
<pre class="r"><code>#Generate the PCA projections using the `plotPCA` function from DESeq2.
p.all &lt;- plotPCA(rld, intgroup = c(&#39;Gtype.Tx&#39;), ntop = 500)</code></pre>
</details>
<p>Next, look at the possible slots of the <code>p.all</code> object to determine where the PCA data is stored. Then, create a ggplot2 object called <code>gp</code>, specifying PC1 as the x-axis and PC2 as the y-axis and setting the color to correspond to the samples and the shape to correspond to the <code>CombinatoricGroup</code>. Add a primary title ‘All samples Rlog-Normalized’</p>
<p><em>Hint: Use aesthetics, e.g.: aes() and search for how to add a title to a ggplot figure</em></p>
<details>
<summary>
<em>Click for solution</em>
</summary>
<pre class="r"><code>gp &lt;- ggplot(p.all$data, aes(x = PC1, y = PC2, color = SampleName, shape = CombinatoricGroup)) +
geom_point() +
ggtitle(label = as.character(&#39;All samples Rlog-Normalized&#39;))</code></pre>
</details>
<p>If you have some extra time, explore the additional plot options that we usually include in our analysis, specifically</p>
<details>
<summary>
<em>Click for example of additional plot options</em>
</summary>
<p>Work through the following plot options, testing out including and including the additional aesthetic commands, to understand how to make a complex but well labeled PCA plot.</p>
<pre class="r"><code>gp &lt;- ggplot(p.all$data, aes(x = PC1, y = PC2, color = SampleName, shape = CombinatoricGroup)) +
    scale_shape_manual(values=1:nlevels(CombinatoricGroup), name = &#39;Combinatoric Group&#39;) +
    geom_point(size=2) +
    ggtitle(label = as.character(&#39;All samples Rlog-Normalized&#39;)) +
    guides(colour=guide_legend(nrow = 12, title = &#39;Sample&#39;)) +
    xlab(p.all$labels[2]) + ylab(p.all$labels[1]) +
    theme_classic(base_size = 10)</code></pre>
</details>
<p>Finally, to output the plot to file, use the <code>pdf()</code> function:</p>
<pre class="r"><code>pdf(file = paste0(plotPath, &#39;PCAplot_Fancy_rlog_&#39;, Comparison, &#39;.pdf&#39;), onefile = TRUE)
plot(gp)
dev.off()</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<details>
<summary>
<em>Bonus: Click for example code for generating a ScreePlot</em>
</summary>
<p>A screeplot is a way to visualize the variance explained by all principle components. To generate a scree plot, the PCA results need to be used independently of plotting, such as described by <a href="https://statquest.org/pca-clearly-explained/">this statquest post</a> and replicated below.</p>
<pre class="r"><code># generate PCA loadings
pca &lt;- prcomp(t(assay(rld)), scale=TRUE)

## get the scree information
pca.var &lt;- pca$sdev^2
scree &lt;- pca.var/sum(pca.var)
barplot((scree[1:10]*100), main=&quot;Scree Plot&quot;, xlab=&quot;Principal Component&quot;, ylab=&quot;Percent Variation&quot;)</code></pre>
<img src="Module09_SampleQCViz_files/figure-html/ScreePlot-1.png" width="672" /> We can see that the majority (~65%) of the variance across our samples is explained by the first three principle components, giving us some additional confidence regarding the quality of our data. In these scree plot examples from BioTuring, the plot on the left fits what we would expect for a dataset with high signal from the experimental treatment, where the majority of the variance is explained by the first few principle components. The plot on the right illustrates a scenario where the variance is distributed across many components, which could be due to low signal from the experimental treatment, complex experimental design, or confounding factors. image: <img src="images/proportion-of-variance-blog-horz.jpg" />
</details>
</div>
<div id="optional---pca-plot-for-raw-data" class="section level4" number="2.3.0.2">
<h4 number="2.3.0.2"><span class="header-section-number">2.3.0.2</span> Optional - PCA plot for raw data</h4>
<p>It can sometimes be useful to also generate a PCA plot for the raw data as well as the normalized data, particularly</p>
<pre class="r"><code>RC &lt;- SummarizedExperiment(log2(counts(dds, normalized = FALSE)), colData=colData(dds))
p.raw &lt;- plotPCA(DESeqTransform(RC), intgroup = c(&#39;Gtype.Tx&#39;), ntop = 500)
p.raw</code></pre>
<p><img src="Module09_SampleQCViz_files/figure-html/PCAPlainRaw-1.png" width="672" /></p>
<p>We see that there is less variance explained by PC2 and that the samples from the same group are not as well clustered for the raw data. Since this is prior to normalization, these differences are likely due to <strong>technical</strong> considerations like sequencing depth differences that are accounted for by the rlog normalization.</p>
<details>
<summary>
<em>Click for code for customized PCA plot of raw data</em>
</summary>
<pre class="r"><code>pdf(file = paste0(plotPath, &#39;PCAplot_raw_&#39;, Comparison, &#39;.pdf&#39;), onefile = TRUE)
#PCA for Raw counts for all samples
RC &lt;- SummarizedExperiment(log2(counts(dds, normalized = FALSE)), colData=colData(dds))
p.RC &lt;- plotPCA(DESeqTransform(RC), intgroup = &#39;Gtype.Tx&#39;)

gpRC &lt;- ggplot(p.RC$data, aes(x = PC1, y = PC2, color = SampleName, shape = CombinatoricGroup)) +     xlab(p.RC$labels[2]) + ylab(p.RC$labels[1]) + scale_shape_manual(values=1:nlevels(CombinatoricGroup), name = &#39;Combinatoric Group&#39;) + geom_point(size=2) + ggtitle(label = as.character(&#39;All samples Raw Data&#39;)) + theme(plot.title = element_text(hjust = 0.5)) + guides(colour=guide_legend(nrow=12, title = &#39;Sample&#39;), legend.key = element_rect(size = 1), legend.key.size = unit(0, &#39;cm&#39;)) + theme_classic(base_size = 10) + theme(legend.margin=margin(t = 0, unit=&#39;mm&#39;))
plot(gpRC)

dev.off()</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<pre class="r"><code># embedd example of plot (rlog only)
plot(gpRC)</code></pre>
<img src="Module09_SampleQCViz_files/figure-html/PCAraw-1.png" width="672" />
</details>
</div>
</div>
</div>
<div id="summary" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Discussed variance within treatment groups<br />
</li>
<li>Discussed technical artifacts, including batches</li>
<li>Learned to generate PCA plots</li>
</ul>
<p><strong>Before moving on, we’ll take a short (15 minute) break.</strong></p>
<hr />
</div>
<div id="sources-used" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Sources Used</h1>
<ul>
<li>HBC QC tutorial: <a href="https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html" class="uri">https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html</a><br />
</li>
<li>Detailed Heatmap tutorial from Galaxy: <a href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html" class="uri">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html</a><br />
</li>
<li>PCA Overview: <a href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/" class="uri">https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed above. These are open access materials distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGF5IDMgLSBNb2R1bGUgMDk6IFNhbXBsZSBWaXN1YWxpemF0aW9ucyBmb3IgUXVhbGl0eSBDb250cm9sIgphdXRob3I6ICJVTSBCaW9pbmZvcm1hdGljcyBDb3JlIgpkYXRlOiAiYHIgU3lzLkRhdGUoKWAiCm91dHB1dDoKICAgICAgICBodG1sX2RvY3VtZW50OgogICAgICAgICAgICBpbmNsdWRlczoKICAgICAgICAgICAgICAgIGluX2hlYWRlcjogaGVhZGVyLmh0bWwKICAgICAgICAgICAgdGhlbWU6IHBhcGVyCiAgICAgICAgICAgIHRvYzogdHJ1ZQogICAgICAgICAgICB0b2NfZGVwdGg6IDQKICAgICAgICAgICAgdG9jX2Zsb2F0OiB0cnVlCiAgICAgICAgICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CmJvZHl7IC8qIE5vcm1hbCAgKi8KICAgICAgZm9udC1zaXplOiAxNHB0OwogIH0KcHJlIHsKICBmb250LXNpemU6IDEycHQKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB0Owp9Cjwvc3R5bGU+Cgo8IS0tLSBBbGxvdyB0aGUgcGFnZSB0byBiZSB3aWRlciAtLS0+CjxzdHlsZT4KICAgIGJvZHkgLm1haW4tY29udGFpbmVyIHsKICAgICAgICBtYXgtd2lkdGg6IDEyMDBweDsKICAgIH0KPC9zdHlsZT4KCj4gIyBPYmplY3RpdmVzOiAgICAgCj4gKiBHZW5lcmF0ZSBjb21tb24gUUMgdmlzdWFsaXphdGlvbnMgICAKPiAqIFVuZGVyc3RhbmQgaG93IHRvIGludGVycHJldCBRQyB2aXN1YWxpemF0aW9ucyAgICAKPiAqIFVuZGVyc3RhbmQgd2hlbiB0byByZXZpc2UgdGhlIG1vZGVsIHVzZWQgaW4gdGhlIERFU2VxMiBpbml0aWFsaXphdGlvbiAgICAKPiAqIFVuZGVyc3RhbmQgdGhlIHBpdGZhbGxzIG9mIHBvc3QtaG9jIGFuYWx5c2lzICAgICAKPiAqIERlc2NyaWJlIHRoZSBjYXVzZXMgYW5kIGltcGxpY2F0aW9ucyBvZiBiYXRjaCBlZmZlY3Qgb3Igb3RoZXIgUUMgaXNzdWVzIGluIGFuIFJOQS1TZXEgZXhwZXJpbWVudCAgICAgCgoKYGBge3IgTW9kdWxlcywgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQpsaWJyYXJ5KERFU2VxMikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KHRpZHlyKQpsaWJyYXJ5KGRwbHlyKQpsaWJyYXJ5KG1hdHJpeFN0YXRzKQpsaWJyYXJ5KGdncmVwZWwpCmxpYnJhcnkocGhlYXRtYXApCmxpYnJhcnkoUkNvbG9yQnJld2VyKQpsb2FkKCJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKCiMgRGlmZmVyZW50aWFsIEV4cHJlc3Npb24gV29ya2Zsb3cKClByaW9yIHRvIHRlc3RpbmcgZm9yIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGJldHdlZW4gb3VyIGNvbXBhcmlzb25zIG9mIGludGVyZXN0LCB3ZSdsbCBmaXJzdCBnZW5lcmF0ZSBwbG90cyB0aGF0IHdpbGwgYXNzZXNzIGhvdyB3ZWxsIG91ciBzYW1wbGVzIG1hdGNoIHVwIHdpdGggb3VyIGV4cGVjdGF0aW9ucyAoYmFzZWQgb24gdGhlaXIgdHJlYXRtZW50IGdyb3VwcykgYW5kIHdoYXQgd2UgbWlnaHQgZXhwZWN0IHRvIHNlZSBmcm9tIG91ciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucy4KCiFbXSguL2ltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLTA1LnBuZyl7d2lkdGg9NzUlfQoKLS0tCgojIFNhbXBsZSBWaXN1YWxpemF0b25zIGZvciBRdWFsaXR5IENvbnRyb2wgICAgIAoKWWVzdGVyZGF5IHdlIGRpc2N1c3NlZCBhc3BlY3RzIG9mIHF1YWxpdHkgY29udHJvbCBhc3Nlc3NtZW50IGF0IHRoZSBzZXF1ZW5jaW5nIGRhdGEgbGV2ZWwuIFRvZGF5IHdlIHdpbGwgb3V0bGluZSBzYW1wbGUtbGV2ZWwgYW5kIGdlbmUtbGV2ZWwgcXVhbGl0eSBjb250cm9sIGFzc2Vzc21lbnRzIHRvIGRldGVybWluZSB3aGF0IHdlIHNob3VsZCBleHBlY3QgZnJvbSBvdXIgZG93bnN0cmVhbSBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucy4KClRvIGRvIHRoaXMsIHdlIHdpbGwgZmlyc3QgYXNzZXNzIHRoZSBzaW1pbGFyaXR5IG9mIG91ciBzYW1wbGVzIGJ5IHVzaW5nIHByaW5jaXBhbCBjb21wb25lbnQgYW5hbHlzaXMgKFBDQSkuIFRoaXMgd2lsbCBhbGxvdyB1cyB0byBkZXRlcm1pbmUgaG93IHdlbGwgcGF0dGVybnMgaW4gdGhlIGRhdGEgZml0cyBvdXIgZXhwZWN0YXRpb25zIGZyb20gdGhlIGV4cGVyaW1lbnRzIGRlc2lnbiBhbmQgcG9zc2libGUgc291cmNlcyBvZiB2YXJpYXRpb24gaW4gdGhlIGRhdGFzZXQuCgpPdGhlciBjb21tb24gdmlzdWFsaXphdGlvbnMgdGhhdCB3ZSBnZW5lcmF0ZSBmb3Igb3VyIGFuYWx5c2VzIGluY2x1ZGUgZXhwcmVzc2lvbiBoZWF0bWFwcywgc2FtcGxlIGNvcnJlbGF0aW9uIGhlYXRtYXBzLCBhbmQgYm94cGxvdHMgb2YgcmF3IGFuZC9vciBub3JtYWxpemVkIGNvdW50cywgdGhlIGNvZGUgZm9yIHdoaWNoIGNhbiBiZSBmb3VuZCBpbiB0aGUgYm9udXMgY29udGVudCBtb2R1bGUuCgoqKlRPRE86IERPVUJMRSBDSEhFQ0sgSU5UUk8gQUZURVIgQ0hBTkdJTkcgVklTVUFMSVpBVElPTioqCgojIyBQcmluY2lwbGUgQ29tcG9uZW50IEFuYWx5c2lzIChQQ0EpIFBsb3RzCgpBIGNvbW1vbiBhbmQgdmVyeSB1c2VmdWwgcGxvdCBmb3IgZXZhbHVhdGluZyBob3cgd2VsbCBvdXIgc2FtcGxlcyBjbHVzdGVyIGJ5IHRyZWF0bWVudCBncm91cHMgYXJlIFByaW5jaXBsZSBDb21wb25lbnQgQW5hbHlzaXMgKFBDQSkgcGxvdHMuIFBDQSBpcyB1c2VkIHRvIGVtcGhhc2l6ZSB2YXJpYXRpb24gYW5kIGJyaW5nIG91dCBwYXR0ZXJucyBpbiBsYXJnZSBkYXRhc2V0cyBieSB1c2luZyBkaW1lbnNpb25hbGl0eSByZWR1dGlvbi4KClRoaXMgaW1hZ2UgZnJvbQpbYSBoZWxwZnVsIHN0ZXAgYnkgc3RlcCBleHBsYWluYXRpb24gb2YgUENBXShodHRwczovL2Jsb2cuYmlvdHVyaW5nLmNvbS8yMDE4LzA2LzE0L3ByaW5jaXBhbC1jb21wb25lbnQtYW5hbHlzaXMtZXhwbGFpbmVkLXNpbXBseS8pIGhlbHBzIHRvIGlsbHVzdHJhdGUgdGhlIHByaW5jaXBsZSBjb21wb25lbnQgcHJvamVjdGlvbnMgZm9yIHR3byBnZW5lcyBtZWFzdXJlZCBpbiBhcHByb3hpbWF0ZWx5IDYwIG1vdXNlIHNhbXBsZXMuIEdlbmVyYWxseSwgdGhpcyBwcm9jZXNzIGlzIHJlcGVhdGVkIGFuZCBhZnRlciBlYWNoIGdlbmUncyBjb250cmlidXRpb24gdG8gYSBwcmluY2lwbGUgY29tcG9uZW50IG9yIHdlaWdodCBpcyBkZXRlcm1pbmVkLCB0aGUgZXhwcmVzc2lvbiBhbmQgd2VpZ2h0IGFyZSBzdW1tZWQgYWNyb3NzIGdlbmVzIGZvciBlYWNoIHNhbXBsZSB0byBjYWxjdWxhdGUgYSB2YWx1ZSBmb3IgZWFjaCBwcmluY2lwbGUgY29tcG9uZW50LgoKCiFbXSguL2ltYWdlcy9CbG9nX3BjYV82Yi5wbmcpCgo+KipOb3RlKio6IEEgbW9yZSBkZXRhaWxlZCBvdmVydmlldyBvZiB0aGUgUENBIHByb2NlZHVyZSBpcyBvdXRsaW5lZCBpbiBbYSBIYXJ2YXJkIENoYW4gQmlvaW5mb3JtYXRpYyBDb3JlIHRyYWluaW5nIG1vZHVsZV0oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvcHJpbmNpcGFsX2NvbXBvbmVudF9hbmFseXNpcy5odG1sKSBhbmQgaXMgYmFzZWQgb24gYSBtb3JlIHRob3JvdWdoIGRlc2NyaXB0aW9uIHByZXNlbnRlZCBpbiBhIFtTdGF0UXVlc3TigJlzIHZpZGVvXShodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PV9VVkhuZUJVQlcwKS4gQWRkaXRpb25hbGx5LCBbdGhpcyBUb3dhcmRzRGF0YVNjaWVuY2UgYmxvZyBwb3N0XShodHRwczovL3Rvd2FyZHNkYXRhc2NpZW5jZS5jb20vcHJpbmNpcGFsLWNvbXBvbmVudC1hbmFseXNpcy0zYzM5ZmJmNWNiOWQpIGdvZXMgdGhyb3VnaCB0aGUgbWF0aCBiZWhpbmQgUENBcy4KCiMjIyBJbnRlcnByZXRpbmcgUENBIHBsb3RzCgoKIVtdKGltYWdlcy9QQ0FwbG90X0ZhbmN5X3Jsb2dfa28uVHgucG5nKXt3aWR0aD03NSV9CgpJbiB0aGlzIHBsb3QsIHdoaWNoIGlzIHNpbWlsYXIgdG8gd2hhdCB3ZSdsbCBnZW5lcmF0ZSBiZWxvdyBmb3Igb3VyIGRhdGEsIHByaW5jaXBsZSBjb21wb25lbnQgMSAoUEMxKSBleHBsYWlucyB+ODAlIG9mIHRoZSB2YXJpYW5jZSBpbiBvdXIgZGF0YSB3aGlsZSBwcmluY2lwbGUgY29tcG9uZW50IDIgKFBDMikgZXhwbGFpbnMgfjEyJSBvZiB0aGUgdmFyaWFuY2UuCgpGb3IgbW9zdCBleHBlcmltZW50cywgd2UgZXhwZWN0IHRoZSBtYWpvcml0eSBvZiB0aGUgdG90YWwgdmFyaWFuY2UgdG8gYmUgZXhwbGFpbmVkIGJ5IHRoZSBmaXJzdCB0d28gb3IgdGhyZWUgcHJpbmNpcGxlIGNvbXBvbmVudHMgc28gdGhpcyBwbG90LgoKKltRdWVzdGlvbl06IEhvdyBtaWdodCB3ZSBpbnRlcnByZXQgdGhlIHZhcmlhbmNlIGV4cGxhaW5lZCBieSBlYWNoIHByaW5jaXBsZSBjb21wb25lbnQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGxhYmVsZWQgc2FtcGxlIHBvaW50cz8qCgoKRm9yIG1vcmUgaW5mb3JtYXRpb24sIHRoaXMgW2hlbHBmdWwgb3ZlcnZpZXcgb2YgUENBIGJhc2ljc10oaHR0cHM6Ly9ibG9nLmJpb3R1cmluZy5jb20vMjAxOC8wNi8xNC9wcmluY2lwYWwtY29tcG9uZW50LWFuYWx5c2lzLWV4cGxhaW5lZC1zaW1wbHkvKSB3YWxrcyB0aHJvdWdoIGJvdGggdGhlIGdlbmVyYXRpb24gYW5kIGludGVycHJldGF0aW9uIG9mIHNpbWlsYXIgcGxvdHMuICAgIAoKCiMjIyBFdmFsdWF0aW5nIGJhdGNoIGVmZmVjdHMgb3IgY29uZm91bmRlcnMKClBDQSBwbG90cyBhcmUgdXNlZnVsIGZvciBldmFsdWF0aW5nIHRoZSBpbXBhY3Qgb2YgZmFjdG9ycyBvdGhlciB0aGFuIHRoZSBleHBlcmltZW50YWwgdHJlYXRtZW50IG9yIGdyb3VwLgoKQXQgdGltZXMsIGJhdGNoIGVmZmVjdHMgY2FuIGJlIHF1aXRlIG9idmlvdXMsIHN1Y2ggYXMgdGhpcyBleGFtcGxlIGZyb20gdGhlIFtERVNlcTIgdmlnbmV0dGVdKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCksIHdoZXJlIHRoZXJlIGlzIGNsZWFyIHNlcGFyYXRpb24gd2l0aGluIHRoZSB0cmVhdG1lbnQgZ3JvdXBzLgoKCiFbXSguL2ltYWdlcy9QQ0ExX0RFU2VxMlZpZ25ldHRlLnBuZykKCklmIHdlIGNvbG9yIG9ubHkgYnkgc2VxdWVuY2luZyBydW4gdHlwZSAocGFpcmVkLWVuZCB2cy4gc2luZ2xlLWVuZCksIHdlIHNlZSB0aGF0IFBDMiAoMjklIG9mIHZhcmlhbmNlKSBpcyBwcmltYXJpbHkgZXhwbGFpbmVkIGJ5IHRoaXMgdGVjaG5pY2FsIGNvdmFyaWF0ZS4KCiFbXSguL2ltYWdlcy9QQ0EyX0RFU2VxMlZpZ25ldHRlLnBuZykKCkhvd2V2ZXIsIHRoZSBzYW1wbGVzIGFyZSBjbGVhcmx5IHNlcGVyYXRlZCBieSBleHBlcmltZW50YWwgY29uZGl0aW9uIG9uIFBDMSwgYW5kIHNpbmNlIFBDMSBleHBsYWlucyBtb3JlIHZhcmlhbmNlIHRoYW4gIFBDMiAqKmFuZCoqIHNpbmNlIHdlIGhhdmUgbm9uLWNvbmZvdW5kZWQgYmF0Y2hlcywgd2UgY291bGQgaW5jb3Jwb3JhdGUgdGhlIHRlY2huaWNhbCBjb3ZhcmlhdGUgaW50byBvdXIgbW9kZWwgZGVzaWduLCBzdWNoIGFzIG91dGxpbmVkIGluIHRoZSBbREVTZXEyIHZpZ25ldHRlXShodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwjbXVsdGktZmFjdG9yLWRlc2lnbnMpLgoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIGNvbXBsZXggZGVzaWduIGRpc2N1c3Npb24qPC9zdW1tYXJ5PgogICAgSW4gZXhwZXJpbWVudHMgd2l0aCBtb3JlIGNvbXBsZXggZGVzaWducywgc3VjaCBhcyB3aGVuIHRoZXJlIGFyZSBpbnRlcmVzZWN0aW5nL211bHRpcGxlIHRyZWF0bWVudCBjb25kaXRpb25zLCBpdCBjYW4gYmUgbGVzcyBjbGVhciB3aGF0IGNvdmFyaWFudHMgYXJlIGluZmx1ZW5jaW5nIGV4cHJlc3Npb24sIHN1Y2ggYXMgaWxsdXN0cmF0ZWQgZnJvbSBbdGhpcyBkb2N1bWVuYXRpb24gZm9yIGEgbWljcm9hcnJheSBhbmFseXNpcyB0b29sXShodHRwOi8vd3d3Lm1vbG1pbmUuY29tL21hZ21hL2dsb2JhbF9hbmFseXNpcy9iYXRjaF9lZmZlY3QuaHRtbCkuCiAgICBGcm9tIHRoZSBQQ0EgbGFiZWxlZCBieSBleHBlcmltZW50YWwgdHJlYXRtZW50LCB3ZSBzZWUgdGhhdCBzYW1wbGVzIGZyb20gdGhlIHRyZWF0bWVudCBncm91cCBkbyBub3QgY2x1c3RlciB0b2dldGhlciBhbmQgdGhhdCB0aGVyZSBpcyBoaWdoIHZhcmlhbmNlIGFjcm9zcyBhbGwgdHJlYXRtZW50IGdyb3Vwcy4KICAgICFbXSguL2ltYWdlcy9iYXRjaF9leDFiLmpwZykKICAgIEhvd2V2ZXIsIHdoZW4gdGhlIHBsb3QgaXMgY29sb3IgY29kZWQgYnkgdGhlIHRlY2huaWNhbCBiYXRjaGVzIG9mIHByb2JlIGxhYmVsaW5nLCB3ZSBzZWUgdGhhdCB0aGUgcGF0dGVybnMgaW4gdGhlIGRhdGEgYXJlIGJldHRlciBleHBsYWluZWQgYnkgYmF0Y2ggdGhhbiB0aGUgZXhwZXJpbWVudGFsIGNvbmRpdGlvbnMuCiAgICAhW10oLi9pbWFnZXMvYmF0Y2hfZXgxYy5qcGcpCjwvZGV0YWlscz4KCiMjIyMgV2hlbiB0byByZW1vdmUgc2FtcGxlcyBvciB1cGRhdGUgdGhlIGRlc2lnbiBmb3JtdWxhCgpHZW5lcmFsbHksIHRoZSBkZWNpc2lvbiB0byByZW1vdmUgc2FtcGxlcyBzaG91bGQgbm90IGJlIHRha2VuIGxpZ2h0bHksIGVzcGVjaWFsbHkgaWYgdGhlIGNvbnNpZGVyYXRpb24gaXMgYmFzZWQgb24gdGhlIGV4cHJlc3Npb24gbGV2ZWwgcGF0dGVybnMgd2UgYXJlIHZpc3VhbGl6aW5nIGluIHRoaXMgc2VjdGlvbiwgYXMgZG9pbmcgc28gd2l0aG91dCBzdWZmaWNpZW50IGp1c3RpZmljYXRpb24gY291bGQgcG90ZW50aWFsbHkgYmlhcyB5b3VyIHJlc3VsdHMuIE90aGVyIHRyYWluaW5nIG1hdGVyaWFscyBoYXZlIGEgc3RlcC1ieS1zdGVwIGV4YW1wbGUgb2YgZXZhbHVhdGluZyBbYmF0Y2ggZWZmZWN0c10oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDNfREdFX1FDX2FuYWx5c2lzLmh0bWwpIHVzaW5nIFBDQXMsIHRoYXQgd2Ugd291bGQgcmVjb21tZW5kIHJldmlld2luZyBwcmlvciB0byByZW1vdmluZyBhbnkgc2FtcGxlcyBmcm9tIHlvdXIgY29tcGFyaXNvbnMuCgoKSWYgeW91ciBQQ0EgcmV2ZWFscyBwYXR0ZXJucyB0aGF0IHdlcmUgbm90IGFjY291bnRlZCBmb3IgaW4gdGhlIGluaXRpYWwgbW9kZWwgZml0LCB0aGUgW0RFU2VxMiB2aWduZXR0ZV0oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI211bHRpLWZhY3Rvci1kZXNpZ25zKSBwcm92aWRlcyBhbiBvdmVydmlldyBvZiBob3cgdG8gYWRkIGFkZGl0aW9uYWwgY292YXJpYXRlcyB0byBhIG1vZGVsIGRlc2lnbiBiZWZvcmUgcmVmaXR0aW5nIHRoZSBERVNlcTIgbW9kZWwgZm9yIGEgZGF0YXNldC4KCiMjIFBsb3QgU2V0dXAKCldlJ3ZlIGFscmVhZHkgbG9hZGVkIHRoZSBsaWJyYXJpZXMgd2UgbmVlZCBmb3IgdGhpcyBtb2R1bGUuIFdlJ2xsIGZvbGxvdyBiZXN0IHByYWN0aWNlcyBhbmQgY3JlYXRlIG5ldyBkaXJlY3RvcmllcyB0byBvcmdhbml6ZSBvdXIgb3V0cHV0IGZpZ3VyZXMsIGFzIHdlbGwgYXMgYSB2YXJpYWJsZSB0byBzdG9yZSBhIGRlc2NyaXB0b3Igb2YgdGhlIGRhdGFzZXQgd2UgYXJlIGxvb2tpbmcgYXQgc28gd2UgY2FuIG1vcmUgZWFzaWx5IHJlY3ljbGUgb3VyIHBsb3R0aW5nIGZ1bmN0aW9ucy4KCmBgYHtyIFNldHVwZGlyZWN0b3J5fQpwbG90UGF0aCA9ICdmaWd1cmVzLycKZGlyLmNyZWF0ZShwbG90UGF0aCwgc2hvd1dhcm5pbmdzID0gRkFMU0UpCkNvbXBhcmlzb24gPC0gIkd0eXBlLlR4IiAjIGRlc2NyaXB0b3IgZm9yIHRoZSBkYXRhc2V0IHdlIGFyZSBsb29raW5nIGF0CmBgYAoKIyMgUENBIFBsb3QgaW5pdGlhbGl6YXRpb24KCkJlbG93LCB3ZSB3aWxsIHBsb3QgdGhlIHJsb2cgbm9ybWFsaXplZCBkYXRhIGZvciBvdXIgc2FtcGxlcyBwcm9qZWN0ZWQgb250byBhIDJEIHBsYW5lIGFuZCBzcGFubmVkIGJ5IHRoZWlyIGZpcnN0IHR3byBwcmluY2lwbGUgY29tcG9uZW50cyB0byB2aXN1YWxpemUgdGhlIG92ZXJhbGwgZWZmZWN0IG9mIGV4cGVyaW1lbnRhbCBjb3ZhcmlhdGVzIGFuZCBkZXRlcm1pbmUgaWYgdGhlcmUgaXMgZXZpZGVuY2Ugb2YgYmF0Y2ggZWZmZWN0cy4KCldlJ2xsIGdlbmVyYXRlIHRoZSBQQ0EgcHJvamVjdGlvbnMgZm9yIHRoZSB0b3AgNTAwIHVzaW5nIHRoZSBgcGxvdFBDQWAgZnVuY3Rpb24gZnJvbSBERVNlcTIsIHNwZWNpZnlpbmcgYEd0eXBlLlR4YCBhcyB0aGUgY29uZGl0aW9uIG9mIGludGVyZXN0LCBhbmQgdmlldyB0aGUgc2ltcGxlIHBsb3QgZ2VuZXJhdGVkIGJ5IHRoZSBmdW5jdGlvbi4KCmBgYHtyIFBDQXJsb2czfQpwLmFsbCA8LSBwbG90UENBKHJsZCwgaW50Z3JvdXAgPSBjKCdHdHlwZS5UeCcpLCBudG9wID0gNTAwKQpwLmFsbApgYGAKCldlIGFsc28gc2VlIHRoYXQgc2FtcGxlcyBpbiBib3RoIGBjb250cm9sYCBncm91cHMgYXJlIGZhaXJseSB0aWdodGx5IGdyb3VwZWQsIHdoaWxlIHNhbXBsZXMgd2l0aGluIGVhY2ggYFR4YCBncm91cCBkbyBub3QgY2x1c3RlciBhcyB0aWdodGx5LiBUaGVyZSBkb2VzIG5vdCBhcHBlYXIgdG8gYmUgYW55IGNsZWFyIGV2aWRlbmNlIG9mIGJhdGNoIGVmZmVjdHMuCgpOZXh0LCB3ZSdsbCBzYXZlIHRoaXMgcGxvdCB0byBmaWxlLgpgYGB7ciBQQ0FybG9nMX0KcGRmKGZpbGUgPSBwYXN0ZTAocGxvdFBhdGgsICdQQ0FwbG90X3Jsb2dfJywgQ29tcGFyaXNvbiwgJy5wZGYnKSwgb25lZmlsZSA9IFRSVUUpCnAuYWxsCmRldi5vZmYoKQpgYGAKCioqQ2hlY2twb2ludCoqOiAqSWYgZ2VuZXJhdGVkIGFuZCBzYXZlZCB0aGUgYHAuYWxsYCBQQ0EgcGxvdCwgcGxlYXNlIGluZGljYXRlIHdpdGggdGhlIGdyZWVuICdjaGVjaycgYnV0dG9uLiBPdGhlcndpc2UsIHBsZWFzZSB1c2UgIHVzZSB0aGUgcmVkICd4JyBidXR0b24gaW4geW91ciB6b29tIHJlYWN0aW9uIHBhbmVsIHRvIGhhdmUgdGhpcyBzdGVwIHJlcGVhdGVkLioKCiMjIyMgW0V4ZXJjaXNlXTogUENBIHBsb3QgY3VzdG9taXphdGlvbiB3aXRoIGdncGxvdDIKCldlIGNhbiBnZW5lcmF0ZSBhIGN1c3RvbWl6ZWQgcGxvdCB1c2luZyB0aGUgYGdncGxvdDJgIHBhY2thZ2UsIGluY2x1ZGluZyBzaGFwZSBhc3NpZ25tZW50cyBmb3Igb3VyIHRyZWF0bWVudCBncm91cHMgYW5kIGNvbG9yIGFzc2lnbm1lbnRzIGZvciB0aGUgaW5kaXZpZHVhbCBzYW1wbGVzLgoKKipUT0RPOiBicmVhayBpbnRvIG11bHRpcGxlIGd1aWRlZCBzdGFuemEncyAod2l0aCBzb2x1dGlvbnMpCgpGaXJzdCwgd2UgbmVlZCB0byBjcmVhdGUgc29tZSBvYmplY3RzIHRvIHN0b3JlIHRoZSBzYW1wbGUgYW5kIGdyb3VwIGluZm9ybWF0aW9uLgpgYGB7ciBQQ0FleGVyY2lzZTF9CiNQQ0EgcGxvdCBmb3IgUmxvZy1Ob3JtYWxpemVkIGNvdW50cyBmb3IgYWxsIHNhbXBsZXMKQ29tYmluYXRvcmljR3JvdXAgPC0gZmFjdG9yKE1ldGFJbmZvJEd0eXBlLlR4KQpTYW1wbGVOYW1lIDwtIGZhY3Rvcihyb3cubmFtZXMoTWV0YUluZm8pKQpgYGAKVGFrZSBhIGxvb2sgYXQgYENvbWJpbmF0b3JpY0dyb3VwYCBhbmQgYFNhbXBsZU5hbWVgIC0gd2hhdCBpbmZvcm1hdGlvbiBpcyBub3cgc3RvcmVkIGluIHRoZXNlIG9iamVjdHM/CgpOZXh0LCBsb29rIGF0IHRoZSBkb2N1bWVudGF0aW9uIGZvciBgcGxvdFBDQWAgZnVuY3Rpb24gZnJvbSBERVNlcTIuIFRoZW4gd3JpdGUgYSBjb21tYW5kIHRvIHN0b3JlIHRoZSBQQ0EgcmVzdWx0cyBmb3IgdGhlIHRvcCA1MDAgZ2VuZXMgZm9yIGBpbnRncm91cGAgPSAnR3R5cGUuVHgnLCB1c2luZyB0aGUgbm9ybWFsaXplZCBkYXRhLCBhcyBhbiBvYmplY3QgbmFtZWQgYHAuYWxsYC4KCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBzb2x1dGlvbio8L3N1bW1hcnk+CmBgYHtyIFBDQWV4ZXJjaXNlMn0KI0dlbmVyYXRlIHRoZSBQQ0EgcHJvamVjdGlvbnMgdXNpbmcgdGhlIGBwbG90UENBYCBmdW5jdGlvbiBmcm9tIERFU2VxMi4KcC5hbGwgPC0gcGxvdFBDQShybGQsIGludGdyb3VwID0gYygnR3R5cGUuVHgnKSwgbnRvcCA9IDUwMCkKYGBgCjwvZGV0YWlscz4KCk5leHQsIGxvb2sgYXQgdGhlIHBvc3NpYmxlIHNsb3RzIG9mIHRoZSBgcC5hbGxgIG9iamVjdCB0byBkZXRlcm1pbmUgd2hlcmUgdGhlIFBDQSBkYXRhIGlzIHN0b3JlZC4gVGhlbiwgY3JlYXRlIGEgZ2dwbG90MiBvYmplY3QgY2FsbGVkIGBncGAsIHNwZWNpZnlpbmcgUEMxIGFzIHRoZSB4LWF4aXMgYW5kIFBDMiBhcyB0aGUgeS1heGlzIGFuZCBzZXR0aW5nIHRoZSBjb2xvciB0byBjb3JyZXNwb25kIHRvIHRoZSBzYW1wbGVzIGFuZCB0aGUgc2hhcGUgdG8gY29ycmVzcG9uZCB0byB0aGUgYENvbWJpbmF0b3JpY0dyb3VwYC4gQWRkIGEgcHJpbWFyeSB0aXRsZSAnQWxsIHNhbXBsZXMgUmxvZy1Ob3JtYWxpemVkJwoKKkhpbnQ6IFVzZSBhZXN0aGV0aWNzLCBlLmcuOiBhZXMoKSBhbmQgc2VhcmNoIGZvciBob3cgdG8gYWRkIGEgdGl0bGUgdG8gYSBnZ3Bsb3QgZmlndXJlKgoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIHNvbHV0aW9uKjwvc3VtbWFyeT4KYGBge3IgUENBZXhlcmNpc2UzfQpncCA8LSBnZ3Bsb3QocC5hbGwkZGF0YSwgYWVzKHggPSBQQzEsIHkgPSBQQzIsIGNvbG9yID0gU2FtcGxlTmFtZSwgc2hhcGUgPSBDb21iaW5hdG9yaWNHcm91cCkpICsKZ2VvbV9wb2ludCgpICsKZ2d0aXRsZShsYWJlbCA9IGFzLmNoYXJhY3RlcignQWxsIHNhbXBsZXMgUmxvZy1Ob3JtYWxpemVkJykpCmBgYAo8L2RldGFpbHM+CgpJZiB5b3UgaGF2ZSBzb21lIGV4dHJhIHRpbWUsIGV4cGxvcmUgdGhlIGFkZGl0aW9uYWwgcGxvdCBvcHRpb25zIHRoYXQgd2UgdXN1YWxseSBpbmNsdWRlIGluIG91ciBhbmFseXNpcywgc3BlY2lmaWNhbGx5Cgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgZXhhbXBsZSBvZiBhZGRpdGlvbmFsIHBsb3Qgb3B0aW9ucyo8L3N1bW1hcnk+CiAgICBXb3JrIHRocm91Z2ggdGhlIGZvbGxvd2luZyBwbG90IG9wdGlvbnMsIHRlc3Rpbmcgb3V0IGluY2x1ZGluZyBhbmQgaW5jbHVkaW5nIHRoZSBhZGRpdGlvbmFsIGFlc3RoZXRpYyBjb21tYW5kcywgdG8gdW5kZXJzdGFuZCBob3cgdG8gbWFrZSBhIGNvbXBsZXggYnV0IHdlbGwgbGFiZWxlZCBQQ0EgcGxvdC4KYGBgIHtyIFBDQWV4ZXJjaXNlQWR2YW5jZWR9CmdwIDwtIGdncGxvdChwLmFsbCRkYXRhLCBhZXMoeCA9IFBDMSwgeSA9IFBDMiwgY29sb3IgPSBTYW1wbGVOYW1lLCBzaGFwZSA9IENvbWJpbmF0b3JpY0dyb3VwKSkgKwogICAgc2NhbGVfc2hhcGVfbWFudWFsKHZhbHVlcz0xOm5sZXZlbHMoQ29tYmluYXRvcmljR3JvdXApLCBuYW1lID0gJ0NvbWJpbmF0b3JpYyBHcm91cCcpICsKICAgIGdlb21fcG9pbnQoc2l6ZT0yKSArCiAgICBnZ3RpdGxlKGxhYmVsID0gYXMuY2hhcmFjdGVyKCdBbGwgc2FtcGxlcyBSbG9nLU5vcm1hbGl6ZWQnKSkgKwogICAgZ3VpZGVzKGNvbG91cj1ndWlkZV9sZWdlbmQobnJvdyA9IDEyLCB0aXRsZSA9ICdTYW1wbGUnKSkgKwogICAgeGxhYihwLmFsbCRsYWJlbHNbMl0pICsgeWxhYihwLmFsbCRsYWJlbHNbMV0pICsKICAgIHRoZW1lX2NsYXNzaWMoYmFzZV9zaXplID0gMTApCmBgYAo8L2RldGFpbHM+CgoKRmluYWxseSwgdG8gb3V0cHV0IHRoZSBwbG90IHRvIGZpbGUsIHVzZSB0aGUgYHBkZigpYCBmdW5jdGlvbjoKCmBgYHtyIFBDQWV4ZXJjaXNlT3V0cHV0fQpwZGYoZmlsZSA9IHBhc3RlMChwbG90UGF0aCwgJ1BDQXBsb3RfRmFuY3lfcmxvZ18nLCBDb21wYXJpc29uLCAnLnBkZicpLCBvbmVmaWxlID0gVFJVRSkKcGxvdChncCkKZGV2Lm9mZigpCmBgYAoKCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkJvbnVzOiBDbGljayBmb3IgZXhhbXBsZSBjb2RlIGZvciBnZW5lcmF0aW5nIGEgU2NyZWVQbG90Kjwvc3VtbWFyeT4KICAgICBBIHNjcmVlcGxvdCBpcyBhIHdheSB0byB2aXN1YWxpemUgdGhlIHZhcmlhbmNlIGV4cGxhaW5lZCBieSBhbGwgcHJpbmNpcGxlIGNvbXBvbmVudHMuCiAgICAgVG8gZ2VuZXJhdGUgYSBzY3JlZSBwbG90LCB0aGUgUENBIHJlc3VsdHMgbmVlZCB0byBiZSB1c2VkIGluZGVwZW5kZW50bHkgb2YgcGxvdHRpbmcsIHN1Y2ggYXMgZGVzY3JpYmVkIGJ5IFt0aGlzIHN0YXRxdWVzdCBwb3N0XShodHRwczovL3N0YXRxdWVzdC5vcmcvcGNhLWNsZWFybHktZXhwbGFpbmVkLykgYW5kIHJlcGxpY2F0ZWQgYmVsb3cuCmBgYHtyIFNjcmVlUGxvdH0KIyBnZW5lcmF0ZSBQQ0EgbG9hZGluZ3MKcGNhIDwtIHByY29tcCh0KGFzc2F5KHJsZCkpLCBzY2FsZT1UUlVFKQoKIyMgZ2V0IHRoZSBzY3JlZSBpbmZvcm1hdGlvbgpwY2EudmFyIDwtIHBjYSRzZGV2XjIKc2NyZWUgPC0gcGNhLnZhci9zdW0ocGNhLnZhcikKYmFycGxvdCgoc2NyZWVbMToxMF0qMTAwKSwgbWFpbj0iU2NyZWUgUGxvdCIsIHhsYWI9IlByaW5jaXBhbCBDb21wb25lbnQiLCB5bGFiPSJQZXJjZW50IFZhcmlhdGlvbiIpCmBgYAogICAgV2UgY2FuIHNlZSB0aGF0IHRoZSBtYWpvcml0eSAofjY1JSkgb2YgdGhlIHZhcmlhbmNlIGFjcm9zcyBvdXIgc2FtcGxlcyBpcyBleHBsYWluZWQgYnkgdGhlIGZpcnN0IHRocmVlIHByaW5jaXBsZSBjb21wb25lbnRzLCBnaXZpbmcgdXMgc29tZSBhZGRpdGlvbmFsIGNvbmZpZGVuY2UgcmVnYXJkaW5nIHRoZSBxdWFsaXR5IG9mIG91ciBkYXRhLgogICAgSW4gdGhlc2Ugc2NyZWUgcGxvdCBleGFtcGxlcyBmcm9tIEJpb1R1cmluZywgdGhlIHBsb3Qgb24gdGhlIGxlZnQgZml0cyB3aGF0IHdlIHdvdWxkIGV4cGVjdCBmb3IgYSBkYXRhc2V0IHdpdGggaGlnaCBzaWduYWwgZnJvbSB0aGUgZXhwZXJpbWVudGFsIHRyZWF0bWVudCwgd2hlcmUgdGhlIG1ham9yaXR5IG9mIHRoZSB2YXJpYW5jZSBpcyBleHBsYWluZWQgYnkgdGhlIGZpcnN0IGZldyBwcmluY2lwbGUgY29tcG9uZW50cy4gVGhlIHBsb3Qgb24gdGhlIHJpZ2h0IGlsbHVzdHJhdGVzIGEgc2NlbmFyaW8gd2hlcmUgdGhlIHZhcmlhbmNlIGlzIGRpc3RyaWJ1dGVkIGFjcm9zcyBtYW55IGNvbXBvbmVudHMsIHdoaWNoIGNvdWxkIGJlIGR1ZSB0byBsb3cgc2lnbmFsIGZyb20gdGhlIGV4cGVyaW1lbnRhbCB0cmVhdG1lbnQsIGNvbXBsZXggZXhwZXJpbWVudGFsIGRlc2lnbiwgb3IgY29uZm91bmRpbmcgZmFjdG9ycy4KaW1hZ2U6ICFbXSguL2ltYWdlcy9wcm9wb3J0aW9uLW9mLXZhcmlhbmNlLWJsb2ctaG9yei5qcGcpCjwvZGV0YWlscz4KCgojIyMjIE9wdGlvbmFsIC0gUENBIHBsb3QgZm9yIHJhdyBkYXRhCgpJdCBjYW4gc29tZXRpbWVzIGJlIHVzZWZ1bCB0byBhbHNvIGdlbmVyYXRlIGEgUENBIHBsb3QgZm9yIHRoZSByYXcgZGF0YSBhcyB3ZWxsIGFzIHRoZSBub3JtYWxpemVkIGRhdGEsIHBhcnRpY3VsYXJseQoKYGBge3IgUENBUGxhaW5SYXd9ClJDIDwtIFN1bW1hcml6ZWRFeHBlcmltZW50KGxvZzIoY291bnRzKGRkcywgbm9ybWFsaXplZCA9IEZBTFNFKSksIGNvbERhdGE9Y29sRGF0YShkZHMpKQpwLnJhdyA8LSBwbG90UENBKERFU2VxVHJhbnNmb3JtKFJDKSwgaW50Z3JvdXAgPSBjKCdHdHlwZS5UeCcpLCBudG9wID0gNTAwKQpwLnJhdwpgYGAKCldlIHNlZSB0aGF0IHRoZXJlIGlzIGxlc3MgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IFBDMiBhbmQgdGhhdCB0aGUgc2FtcGxlcyBmcm9tIHRoZSBzYW1lIGdyb3VwIGFyZSBub3QgYXMgd2VsbCBjbHVzdGVyZWQgZm9yIHRoZSByYXcgZGF0YS4gU2luY2UgdGhpcyBpcyBwcmlvciB0byBub3JtYWxpemF0aW9uLCB0aGVzZSBkaWZmZXJlbmNlcyBhcmUgbGlrZWx5IGR1ZSB0byAqKnRlY2huaWNhbCoqIGNvbnNpZGVyYXRpb25zIGxpa2Ugc2VxdWVuY2luZyBkZXB0aCBkaWZmZXJlbmNlcyB0aGF0IGFyZSBhY2NvdW50ZWQgZm9yIGJ5IHRoZSBybG9nIG5vcm1hbGl6YXRpb24uICAKCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBjb2RlIGZvciBjdXN0b21pemVkIFBDQSBwbG90IG9mIHJhdyBkYXRhKjwvc3VtbWFyeT4KYGBge3IgUENBcmF3fQpwZGYoZmlsZSA9IHBhc3RlMChwbG90UGF0aCwgJ1BDQXBsb3RfcmF3XycsIENvbXBhcmlzb24sICcucGRmJyksIG9uZWZpbGUgPSBUUlVFKQojUENBIGZvciBSYXcgY291bnRzIGZvciBhbGwgc2FtcGxlcwpSQyA8LSBTdW1tYXJpemVkRXhwZXJpbWVudChsb2cyKGNvdW50cyhkZHMsIG5vcm1hbGl6ZWQgPSBGQUxTRSkpLCBjb2xEYXRhPWNvbERhdGEoZGRzKSkKcC5SQyA8LSBwbG90UENBKERFU2VxVHJhbnNmb3JtKFJDKSwgaW50Z3JvdXAgPSAnR3R5cGUuVHgnKQoKZ3BSQyA8LSBnZ3Bsb3QocC5SQyRkYXRhLCBhZXMoeCA9IFBDMSwgeSA9IFBDMiwgY29sb3IgPSBTYW1wbGVOYW1lLCBzaGFwZSA9IENvbWJpbmF0b3JpY0dyb3VwKSkgKyAgICAgeGxhYihwLlJDJGxhYmVsc1syXSkgKyB5bGFiKHAuUkMkbGFiZWxzWzFdKSArIHNjYWxlX3NoYXBlX21hbnVhbCh2YWx1ZXM9MTpubGV2ZWxzKENvbWJpbmF0b3JpY0dyb3VwKSwgbmFtZSA9ICdDb21iaW5hdG9yaWMgR3JvdXAnKSArIGdlb21fcG9pbnQoc2l6ZT0yKSArIGdndGl0bGUobGFiZWwgPSBhcy5jaGFyYWN0ZXIoJ0FsbCBzYW1wbGVzIFJhdyBEYXRhJykpICsgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChoanVzdCA9IDAuNSkpICsgZ3VpZGVzKGNvbG91cj1ndWlkZV9sZWdlbmQobnJvdz0xMiwgdGl0bGUgPSAnU2FtcGxlJyksIGxlZ2VuZC5rZXkgPSBlbGVtZW50X3JlY3Qoc2l6ZSA9IDEpLCBsZWdlbmQua2V5LnNpemUgPSB1bml0KDAsICdjbScpKSArIHRoZW1lX2NsYXNzaWMoYmFzZV9zaXplID0gMTApICsgdGhlbWUobGVnZW5kLm1hcmdpbj1tYXJnaW4odCA9IDAsIHVuaXQ9J21tJykpCnBsb3QoZ3BSQykKCmRldi5vZmYoKQoKIyBlbWJlZGQgZXhhbXBsZSBvZiBwbG90IChybG9nIG9ubHkpCnBsb3QoZ3BSQykKYGBgCjwvZGV0YWlscz4KCgoKIyBTdW1tYXJ5CgpJbiB0aGlzIHNlY3Rpb24sIHdlOiAgICAKCiogRGlzY3Vzc2VkIHZhcmlhbmNlIHdpdGhpbiB0cmVhdG1lbnQgZ3JvdXBzICAgICAKKiBEaXNjdXNzZWQgdGVjaG5pY2FsIGFydGlmYWN0cywgaW5jbHVkaW5nIGJhdGNoZXMKKiBMZWFybmVkIHRvIGdlbmVyYXRlIFBDQSBwbG90cwoKKipCZWZvcmUgbW92aW5nIG9uLCB3ZSdsbCB0YWtlIGEgc2hvcnQgKDE1IG1pbnV0ZSkgYnJlYWsuKioKCgotLS0KCgojIFNvdXJjZXMgVXNlZCAgICAKKiBIQkMgUUMgdHV0b3JpYWw6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzAzX0RHRV9RQ19hbmFseXNpcy5odG1sICAgIAoqIERldGFpbGVkIEhlYXRtYXAgdHV0b3JpYWwgZnJvbSBHYWxheHk6IGh0dHBzOi8vdHJhaW5pbmcuZ2FsYXh5cHJvamVjdC5vcmcvdHJhaW5pbmctbWF0ZXJpYWwvdG9waWNzL3RyYW5zY3JpcHRvbWljcy90dXRvcmlhbHMvcm5hLXNlcS12aXotd2l0aC1oZWF0bWFwMi90dXRvcmlhbC5odG1sICAgCiogUENBIE92ZXJ2aWV3OiBodHRwczovL2Jsb2cuYmlvdHVyaW5nLmNvbS8yMDE4LzA2LzE0L3ByaW5jaXBhbC1jb21wb25lbnQtYW5hbHlzaXMtZXhwbGFpbmVkLXNpbXBseS8gICAgIAoKCgpgYGB7ciBXcml0ZU91dC5SRGF0YSwgZXZhbD1GQUxTRSwgZWNobz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KI0hpZGRlbiBjb2RlIGJsb2NrIHRvIHdyaXRlIG91dCBkYXRhIGZvciBrbml0dGluZwpzYXZlLmltYWdlKGZpbGUgPSAicmRhdGEvUnVubmluZ0RhdGEuUkRhdGEiKQpgYGAKCgoKLS0tCgoKVGhlc2UgbWF0ZXJpYWxzIGhhdmUgYmVlbiBhZGFwdGVkIGFuZCBleHRlbmRlZCBmcm9tIG1hdGVyaWFscyBsaXN0ZWQgYWJvdmUuIFRoZXNlIGFyZSBvcGVuIGFjY2VzcyBtYXRlcmlhbHMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBbQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbiBsaWNlbnNlIChDQyBCWSA0LjApXShodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS80LjAvKSwgd2hpY2ggcGVybWl0cyB1bnJlc3RyaWN0ZWQgdXNlLCBkaXN0cmlidXRpb24sIGFuZCByZXByb2R1Y3Rpb24gaW4gYW55IG1lZGl1bSwgcHJvdmlkZWQgdGhlIG9yaWdpbmFsIGF1dGhvciBhbmQgc291cmNlIGFyZSBjcmVkaXRlZC4K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module09_SampleQCViz.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
